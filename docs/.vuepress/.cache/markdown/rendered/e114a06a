{"content":"<p>åœ¨æ·±åº¦å­¦ä¹ æµªæ½®å¸­å·äººå·¥æ™ºèƒ½çš„å„ä¸ªé¢†åŸŸä¹‹å‰ï¼Œæ¨èç³»ç»Ÿç”±ååŒè¿‡æ»¤ã€é€»è¾‘å›å½’ï¼ˆLRï¼‰å’Œå› å­åˆ†è§£æœºï¼ˆFMï¼‰ç­‰æ¨¡å‹ä¸»å¯¼ã€‚è¿™äº›æ¨¡å‹ç®€æ´ã€æœ‰æ•ˆï¼Œä½†å®ƒä»¬å…±åŒçš„&quot;é˜¿å–€ç‰æ–¯ä¹‹è¸µ&quot;æ˜¯â€”â€”<strong>ç‰¹å¾å·¥ç¨‹ï¼ˆFeature Engineeringï¼‰</strong>ã€‚ç®—æ³•å·¥ç¨‹å¸ˆä»¬å¦‚åŒæ‰‹å·¥è‰ºäººï¼Œéœ€è¦å‡­å€Ÿå¤§é‡çš„é¢†åŸŸçŸ¥è¯†ã€ç»éªŒå’Œç›´è§‰ï¼Œæ‰‹åŠ¨è®¾è®¡æœ‰æ•ˆçš„äº¤å‰ç‰¹å¾ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè€Œä¸”å¾€å¾€éš¾ä»¥å‘æ˜å‡ºæ•°æ®ä¸­é‚£äº›&quot;åç›´è§‰&quot;çš„éšè—æ¨¡å¼ã€‚</p>\n<p>2016å¹´ï¼ŒGoogleä¸€ç¯‡ã€ŠWide &amp; Deep Learning for Recommender Systemsã€‹æ¨ªç©ºå‡ºä¸–ï¼Œå¦‚åŒä¸€å£°å·è§’ï¼Œæ­£å¼å®£å‘Šäº†æ¨èç³»ç»Ÿ&quot;æ–‡è‰ºå¤å…´&quot;æ—¶ä»£çš„åˆ°æ¥ã€‚è¿™åœºå¤å…´çš„æ ¸å¿ƒï¼Œæ­£æ˜¯<strong>ç”¨æ·±åº¦å­¦ä¹ å®ç°&quot;ç«¯åˆ°ç«¯&quot;çš„è‡ªåŠ¨åŒ–ç‰¹å¾å­¦ä¹ </strong>ï¼Œå°†å·¥ç¨‹å¸ˆä»ç¹é‡çš„ä½“åŠ›åŠ³åŠ¨ä¸­è§£æ”¾å‡ºæ¥ï¼Œå»æ¢ç´¢æ›´å¹¿é˜”çš„æ¨¡å‹ç»“æ„å’Œä¸šåŠ¡è¾¹ç•Œã€‚</p>\n<h2 id=\"ğŸš€-èŒƒå¼é©å‘½-ä»-ç‰¹å¾å·¥ç¨‹-åˆ°-è¡¨ç¤ºå­¦ä¹ \" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸš€-èŒƒå¼é©å‘½-ä»-ç‰¹å¾å·¥ç¨‹-åˆ°-è¡¨ç¤ºå­¦ä¹ \"><span>ğŸš€ èŒƒå¼é©å‘½ï¼šä»&quot;ç‰¹å¾å·¥ç¨‹&quot;åˆ°&quot;è¡¨ç¤ºå­¦ä¹ &quot;</span></a></h2>\n<p>æ·±åº¦å­¦ä¹ å¸¦æ¥çš„é©å‘½ï¼Œå…¶æœ¬è´¨æ˜¯ <strong>è¡¨ç¤ºå­¦ä¹ ï¼ˆRepresentation Learningï¼‰</strong> ä»£æ›¿äº†æ‰‹å·¥ç‰¹å¾å·¥ç¨‹ã€‚</p>\n<ul>\n<li><strong>æ—§èŒƒå¼</strong>ï¼š<code v-pre>åŸå§‹æ•°æ® -&gt; äººå·¥ç‰¹å¾å·¥ç¨‹ -&gt; ç®€å•æ¨¡å‹ï¼ˆå¦‚LRï¼‰ -&gt; é¢„æµ‹</code></li>\n<li><strong>æ–°èŒƒå¼</strong>ï¼š<code v-pre>åŸå§‹æ•°æ® -&gt; è‡ªåŠ¨è¡¨ç¤ºå­¦ä¹ ï¼ˆEmbeddingï¼‰ -&gt; å¤æ‚æ¨¡å‹ï¼ˆå¦‚DNNï¼‰ -&gt; é¢„æµ‹</code></li>\n</ul>\n<p><strong>åµŒå…¥ï¼ˆEmbeddingï¼‰</strong> æ˜¯è¿™åœºé©å‘½çš„åŸºçŸ³ã€‚å®ƒå°†æ¯ä¸€ä¸ªåŸå§‹ã€é«˜ç»´ã€ç¨€ç–çš„ç‰¹å¾ï¼ˆå¦‚æ¯ä¸€ä¸ª<code v-pre>user_id</code>æˆ–<code v-pre>item_id</code>ï¼‰ï¼Œæ˜ å°„åˆ°ä¸€ä¸ªä½ç»´ã€ç¨ å¯†çš„å‘é‡ç©ºé—´ä¸­ã€‚åœ¨è¿™ä¸ªç¥å¥‡çš„ç©ºé—´é‡Œï¼Œç›¸ä¼¼çš„ç‰©å“æˆ–ç”¨æˆ·åœ¨è·ç¦»ä¸Šä¼šæ›´æ¥è¿‘ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™äº›åµŒå…¥å‘é‡æˆä¸ºäº†ç¥ç»ç½‘ç»œçš„&quot;é€šç”¨è¯­è¨€&quot;ï¼Œä½¿å¾—ç«¯åˆ°ç«¯çš„å­¦ä¹ æˆä¸ºå¯èƒ½ã€‚</p>\n<Mermaid id=\"mermaid-27\" code=\"eJxLL0osyFAIceFSAILi0iQIX+nZ9OUvepqf7ul/v2fW886dT/c1Pt2+9PmKbiWwOhBIySxKTS7JzM9T8AmCCzpGP+2b/3R5t6dLrIKurp2CU7USsm6bpCJ9O43UdCuFxPTU+PTUvJTUIh2FzJLU3PjkxJJUTaVasC7naJ8gfTffWLCxQEVc6I6btgHuuBcLVzxfsuvp2mVPdi4g4DgXNMe5Viu55ialpqRk5qU/3dgEcdyL9lVPu1ZAzIO5xy36+YoFT9e3PZ0w8WV7P0Sze7SLnx/ChSAaTDiDZQOiXy5qeba1G6LAHSLGBQDLmov3\"></Mermaid><h2 id=\"ğŸ¯-æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸ¯-æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯\"><span>ğŸ¯ æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯</span></a></h2>\n<p>æ·±åº¦å­¦ä¹ æ¨èæ¨¡å‹çš„æ¼”è¿›ï¼Œæ¸…æ™°åœ°åæ˜ äº†ä¸šç•Œå¯¹&quot;è®°å¿†&quot;ä¸&quot;æ³›åŒ–&quot;èƒ½åŠ›ã€ä»¥åŠå¯¹ç”¨æˆ·å…´è¶£ç†è§£æ·±åº¦çš„ä¸æ–­è¿½æ±‚ã€‚</p>\n<h3 id=\"_1-wide-deep-è®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-wide-deep-è®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹\"><span>1. Wide &amp; Deepï¼šè®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹</span></a></h3>\n<p>Wide &amp; Deepæ¨¡å‹çš„è®¾è®¡å“²å­¦å……æ»¡äº†æ™ºæ…§çš„å¹³è¡¡ã€‚å®ƒæ²¡æœ‰å®Œå…¨æŠ›å¼ƒä¼ ç»Ÿæ–¹æ³•çš„ä¼˜ç‚¹ï¼Œè€Œæ˜¯å°†ä¸¤è€…å·§å¦™åœ°ç»“åˆèµ·æ¥ï¼Œæ˜¯&quot;æ‰¿å‰å¯å&quot;çš„ç»å…¸ä¹‹ä½œã€‚</p>\n<ul>\n<li><strong>Wideéƒ¨åˆ†ï¼ˆè®°å¿†ï¼‰</strong>ï¼šæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¹¿ä¹‰çº¿æ€§æ¨¡å‹ã€‚å®ƒè´Ÿè´£&quot;è®°å¿†&quot;é‚£äº›åœ¨å†å²æ•°æ®ä¸­è¢«åå¤éªŒè¯è¿‡çš„ã€é‡è¦çš„ã€æ˜¾å¼çš„äº¤å‰ç‰¹å¾ã€‚ä¾‹å¦‚ï¼Œ<code v-pre>AND(user_gender=female, item_category=cosmetics)</code> è¿™ç§å¼ºå…±ç°è§„åˆ™ï¼Œå¯ä»¥è¢«Wideéƒ¨åˆ†å¿«é€Ÿã€ç²¾å‡†åœ°è®°ä½ã€‚è¿™éƒ¨åˆ†é€šå¸¸ä½¿ç”¨éœ€è¦äººå·¥è®¾è®¡çš„ç¨€ç–äº¤å‰ç‰¹å¾ã€‚</li>\n<li><strong>Deepéƒ¨åˆ†ï¼ˆæ³›åŒ–ï¼‰</strong>ï¼šæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆDNNï¼‰ã€‚å®ƒè´Ÿè´£&quot;æ³›åŒ–&quot;ï¼Œé€šè¿‡ç‰¹å¾çš„å¤šæ¬¡éçº¿æ€§å˜æ¢ï¼Œæ¢ç´¢é‚£äº›ä»æœªæˆ–å¾ˆå°‘åœ¨å†å²ä¸­å‡ºç°è¿‡çš„ã€æ½œåœ¨çš„ç‰¹å¾ç»„åˆã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨æˆ·ä»æœªä¹°è¿‡&quot;å¸å¦†æ°´&quot;ï¼Œä½†Deepæ¨¡å‹å¯ä»¥æ ¹æ®å¥¹è´­ä¹°&quot;ç²‰åº•æ¶²&quot;å’Œ&quot;çœ¼å½±&quot;çš„è¡Œä¸ºï¼Œæ³›åŒ–å‡ºå¥¹å¯¹&quot;å¸å¦†æ°´&quot;çš„æ½œåœ¨å…´è¶£ã€‚è¿™éƒ¨åˆ†é€šå¸¸ä½¿ç”¨ç”¨æˆ·çš„ç”»åƒç‰¹å¾å’Œç‰©å“çš„å±æ€§ç‰¹å¾ã€‚</li>\n</ul>\n<p><strong>æœ€ç»ˆé¢„æµ‹æ˜¯ä¸¤éƒ¨åˆ†çš„åŠ æƒå’Œ</strong>ï¼Œå†é€šè¿‡Sigmoidå‡½æ•°è¾“å‡ºï¼š\n<span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">âˆ£</mi><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">w</mi><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow><mi>T</mi></msubsup><mi mathvariant=\"bold\">x</mi><mo>+</mo><msubsup><mi mathvariant=\"bold\">w</mi><mrow><mi>d</mi><mi>e</mi><mi>e</mi><mi>p</mi></mrow><mi>T</mi></msubsup><msup><mi mathvariant=\"bold\">a</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>l</mi><mi>f</mi></msub><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[ P(Y=1|\\mathbf{x}) = \\sigma(\\mathbf{w}_{wide}^T \\mathbf{x} + \\mathbf{w}_{deep}^T \\mathbf{a}^{(l_f)} + b) ]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1âˆ£</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1244em;vertical-align:-0.2831em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4169em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3072em;vertical-align:-0.4192em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4169em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">ee</span><span class=\"mord mathnormal mtight\">p</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4192em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2901em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)]</span></span></span></span></p>\n<details class=\"hint-container details\"><summary>Wide &amp; Deep æ ¸å¿ƒé€»è¾‘å®ç°</summary>\n<div class=\"language-python line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"python\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-python\"><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">from</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ...</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">basic</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">layers </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"--shiki-light:#2E8F82;--shiki-dark:#5DA994\"> WideDeep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nn</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Module</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Wide &#x26; Deep Learning model.</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">    Args:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        wide_features (list): the list of `Feature Class`, training by the wide part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        deep_features (list): the list of `Feature Class`, training by the deep part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        mlp_params (dict): the params of the last MLP module, keys include:`{\"dims\":list, \"activation\":str, \"dropout\":float, \"output_layer\":bool`}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> wide_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">        super</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">WideDeep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">).</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">__init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> wide_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> wide_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_features </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> **</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> forward</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_wide </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, wide_dims]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, deep_dims]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_wide </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_wide</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, 1]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_deep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, 1]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_wide </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_deep</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sigmoid</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">y</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">squeeze</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></details>\n<h3 id=\"_2-deepfm-ç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-deepfm-ç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰\"><span>2. DeepFMï¼šç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰</span></a></h3>\n<p>Wide &amp; Deepè™½ç„¶å¼ºå¤§ï¼Œä½†å®ƒçš„Wideéƒ¨åˆ†ä»ç„¶ä¾èµ–äººå·¥è®¾è®¡ç‰¹å¾ï¼Œæœªèƒ½å®Œå…¨å®ç°ç«¯åˆ°ç«¯ã€‚<strong>DeepFM (Deep Factorization Machine)</strong> çš„å‡ºç°ï¼Œä¼˜é›…åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>DeepFMçš„æ ¸å¿ƒåˆ›æ–°åœ¨äºï¼š<strong>å®ƒå°†Wideéƒ¨åˆ†æ›¿æ¢ä¸ºäº†ä¸€ä¸ªå› å­åˆ†è§£æœºï¼ˆFMï¼‰</strong>ï¼Œå¹¶ä¸”è¿™ä¸ªFMç»„ä»¶ä¸Deepç»„ä»¶<strong>å…±äº«åŒä¸€å¥—è¾“å…¥åµŒå…¥</strong>ã€‚</p>\n<ul>\n<li><strong>FMç»„ä»¶</strong>ï¼šè´Ÿè´£å­¦ä¹ <strong>ä¸€é˜¶å’ŒäºŒé˜¶ç‰¹å¾äº¤å‰</strong>ã€‚å®ƒèƒ½åƒ<code v-pre>Wide</code>éƒ¨åˆ†ä¸€æ ·æ•æ‰ç‰¹å¾çš„ç›´æ¥å…³è”ï¼Œä½†æ— éœ€äººå·¥è®¾è®¡ã€‚ä¾‹å¦‚ï¼Œ<code v-pre>user_id</code>çš„åµŒå…¥å’Œ<code v-pre>item_id</code>çš„åµŒå…¥å‘é‡åšå†…ç§¯ï¼Œå°±è‡ªåŠ¨åœ°å­¦ä¹ äº†è¿™å¯¹IDçš„äºŒé˜¶äº¤å‰ç‰¹å¾ã€‚</li>\n<li><strong>Deepç»„ä»¶</strong>ï¼šä¸Wide &amp; Deepä¸­çš„Deepéƒ¨åˆ†å®Œå…¨ä¸€æ ·ï¼Œè´Ÿè´£å­¦ä¹ <strong>é«˜é˜¶çš„ã€éšå«çš„ç‰¹å¾äº¤å‰</strong>ã€‚</li>\n</ul>\n<p>è¿™ç§å…±äº«åµŒå…¥çš„æ¶æ„å¸¦æ¥äº†ä¸¤å¤§å¥½å¤„ï¼š</p>\n<ol>\n<li><strong>ç«¯åˆ°ç«¯è®­ç»ƒ</strong>ï¼šä¸å†éœ€è¦ä»»ä½•äººå·¥ç‰¹å¾å·¥ç¨‹ã€‚</li>\n<li><strong>æ•ˆç‡ä¸æ•ˆæœ</strong>ï¼šæ¨¡å‹ä»åŸå§‹ç‰¹å¾ä¸­åŒæ—¶å­¦ä¹ äº†ä¸€é˜¶ã€äºŒé˜¶å’Œé«˜é˜¶çš„äº¤å‰ï¼Œæ•ˆæœæ›´å¥½ï¼Œä¸”å‚æ•°å…±äº«ä½¿å¾—è®­ç»ƒæ›´é«˜æ•ˆã€‚</li>\n</ol>\n<details class=\"hint-container details\"><summary>DeepFM æ ¸å¿ƒé€»è¾‘å®ç°</summary>\n<div class=\"language-python line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"python\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-python\"><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">from</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ...</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">basic</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">layers </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> FM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"--shiki-light:#2E8F82;--shiki-dark:#5DA994\"> DeepFM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nn</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Module</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Deep Factorization Machine Model</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">    Args:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        deep_features (list): the list of `Feature Class`, training by the deep part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        fm_features (list): the list of `Feature Class`, training by the fm part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        mlp_params (dict): the params of the last MLP module, keys include:`{\"dims\":list, \"activation\":str, \"dropout\":float, \"output_layer\":bool`}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">        super</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">DeepFM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">).</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">__init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 1-odrder interaction</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> FM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">reduce_sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 2-odrder interaction</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> **</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> forward</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, deep_dims]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_fm </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">False</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, num_fields, embed_dim]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_linear </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_fm</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">flatten</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">start_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_fm </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_fm</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_deep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, 1]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_linear </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_fm </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_deep</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sigmoid</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">y</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">squeeze</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></details>\n<h3 id=\"_3-din-æ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-din-æ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£\"><span>3. DINï¼šæ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£</span></a></h3>\n<p>æ— è®ºæ˜¯Wide&amp;Deepè¿˜æ˜¯DeepFMï¼Œå®ƒä»¬åœ¨å¤„ç†ç”¨æˆ·å†å²è¡Œä¸ºæ—¶ï¼Œé€šå¸¸åªæ˜¯å°†è¡Œä¸ºåºåˆ—çš„åµŒå…¥å‘é‡è¿›è¡Œç®€å•çš„æ± åŒ–ï¼ˆå¦‚æ±‚å’Œæˆ–å¹³å‡ï¼‰ï¼Œè¿™ç­‰äºæŠŠç”¨æˆ·ä¸°å¯Œå¤šå½©çš„å…´è¶£ï¼ˆå¦‚&quot;çˆ±çœ‹ç¯®çƒ&quot;ã€&quot;åˆšä¹°äº†ç›¸æœº&quot;ã€&quot;æœ€è¿‘åœ¨å¬å¤å…¸ä¹&quot;ï¼‰å‹ç¼©æˆäº†ä¸€ä¸ªæ¨¡ç³Šçš„å¹³å‡å…´è¶£ã€‚</p>\n<p><strong>DIN (Deep Interest Network)</strong> é©å‘½æ€§åœ°æŒ‡å‡ºï¼š<strong>ç”¨æˆ·çš„å…´è¶£æ˜¯åŠ¨æ€çš„ï¼Œåº”è¯¥æ ¹æ®å½“å‰çš„&quot;ç›®æ ‡&quot;æ¥å†³å®šå…³æ³¨å†å²ä¸­çš„å“ªéƒ¨åˆ†ä¿¡æ¯ã€‚</strong> å½“å‘ä¸€ä¸ªç”¨æˆ·æ¨è&quot;ç¯®çƒé‹&quot;æ—¶ï¼Œä»–æœ€è¿‘æµè§ˆ&quot;ç¯®çƒæ¯”èµ›&quot;çš„è¡Œä¸ºå°±åº”è¯¥æ¯”ä»–ä¸Šå‘¨è´­ä¹°&quot;ç›¸æœº&quot;çš„è¡Œä¸ºè·å¾—æ›´é«˜çš„æƒé‡ã€‚</p>\n<p>DINä¸ºæ­¤è®¾è®¡äº†<strong>æ³¨æ„åŠ›æœºåˆ¶ï¼ˆAttention Mechanismï¼‰</strong>ï¼š</p>\n<ul>\n<li>å®ƒå°†<strong>å€™é€‰ç‰©å“ï¼ˆTarget Itemï¼‰</strong> ä½œä¸º&quot;æŸ¥è¯¢ï¼ˆQueryï¼‰&quot;ã€‚</li>\n<li>å°†ç”¨æˆ·çš„<strong>å†å²è¡Œä¸ºåºåˆ—ï¼ˆHistory Behaviorsï¼‰</strong> ä½œä¸º&quot;é”®ï¼ˆKeysï¼‰&quot;å’Œ&quot;å€¼ï¼ˆValuesï¼‰&quot;ã€‚</li>\n<li>é€šè¿‡ä¸€ä¸ª&quot;æ³¨æ„åŠ›æ¿€æ´»å•å…ƒ&quot;ï¼ˆæœ¬è´¨æ˜¯ä¸ªå°å‹MLPï¼‰ï¼Œè®¡ç®—å€™é€‰ç‰©å“ä¸æ¯ä¸€æ¡å†å²è¡Œä¸ºçš„&quot;ç›¸å…³æ€§å¾—åˆ†&quot;ã€‚</li>\n<li>æœ€åï¼Œç”¨è¿™äº›å¾—åˆ†ä½œä¸ºæƒé‡ï¼Œå¯¹å†å²è¡Œä¸ºåºåˆ—çš„åµŒå…¥è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°ä¸€ä¸ªä¸ºå½“å‰å€™é€‰ç‰©å“&quot;é‡èº«å®šåˆ¶&quot;çš„ç”¨æˆ·å…´è¶£è¡¨ç¤ºã€‚</li>\n</ul>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>UserInterest</mtext><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">c</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msub><mi>Î±</mi><mi>i</mi></msub><mo>â‹…</mo><msub><mi mathvariant=\"bold\">h</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mtext>attention</mtext><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">c</mi><mo separator=\"true\">,</mo><msub><mi mathvariant=\"bold\">h</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>â‹…</mo><msub><mi mathvariant=\"bold\">h</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\text{UserInterest}(\\mathbf{c}) = \\sum_{i=1}^{T} \\alpha_i \\cdot \\mathbf{h}_i = \\sum_{i=1}^{T} \\text{attention}(\\mathbf{c}, \\mathbf{h}_i) \\cdot \\mathbf{h}_i \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">UserInterest</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">attention</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">c</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>DINæ ‡å¿—ç€æ¨èæ¨¡å‹ä»å¯¹&quot;é™æ€ç”¨æˆ·ç”»åƒ&quot;çš„ç†è§£ï¼Œè¿ˆå‘äº†å¯¹&quot;åŠ¨æ€ç”¨æˆ·æ„å›¾&quot;çš„æ•æ‰ã€‚</p>\n<h2 id=\"ğŸ™ï¸-åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§-å¤šä»»åŠ¡å­¦ä¹ \" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸ™ï¸-åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§-å¤šä»»åŠ¡å­¦ä¹ \"><span>ğŸ™ï¸ åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§ï¼šå¤šä»»åŠ¡å­¦ä¹ </span></a></h2>\n<p>åœ¨çœŸå®çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¸åªå…³å¿ƒ<strong>ç‚¹å‡»ç‡ï¼ˆCTRï¼‰</strong>ï¼Œè¿˜å…³å¿ƒ<strong>è½¬åŒ–ç‡ï¼ˆCVRï¼‰</strong>ã€<strong>è§‚çœ‹æ—¶é•¿</strong>ã€<strong>åˆ†äº«ç‡</strong>ç­‰å¤šä¸ªæŒ‡æ ‡ã€‚å¤šä»»åŠ¡å­¦ä¹ ï¼ˆMulti-Task Learning, MTLï¼‰å°±æ˜¯ä¸ºäº†åŒæ—¶ä¼˜åŒ–è¿™äº›ç›®æ ‡è€Œè®¾è®¡çš„ã€‚</p>\n<p>æœ€ç»å…¸çš„æ¨¡å‹ä¹‹ä¸€æ˜¯ <strong>ESMM (Entire Space Multi-task Model)</strong>ï¼Œå®ƒå·§å¦™åœ°åˆ©ç”¨äº†ä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»ã€‚åœ¨ç”µå•†åœºæ™¯ä¸­ï¼Œç”¨æˆ·å¿…é¡»å…ˆ&quot;ç‚¹å‡»&quot;å•†å“ï¼Œæ‰å¯èƒ½&quot;è´­ä¹°&quot;å•†å“ã€‚å› æ­¤ï¼Œè½¬åŒ–ï¼ˆPurchaseï¼‰è¡Œä¸ºå¿…ç„¶å‘ç”Ÿåœ¨ç‚¹å‡»ï¼ˆClickï¼‰è¡Œä¸ºä¹‹åã€‚ESMMåˆ©ç”¨è¿™ä¸ªå…³ç³»ï¼Œå°†é¢„æµ‹ç›®æ ‡åˆ†è§£ä¸ºï¼š</p>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>conversion</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>impression</mtext><mo stretchy=\"false\">)</mo><mo>=</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>click</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>impression</mtext><mo stretchy=\"false\">)</mo><mo>Ã—</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>conversion</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>click</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\text{conversion} | \\text{impression}) = p(\\text{click} | \\text{impression}) \\times p(\\text{conversion} | \\text{click}) \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">conversion</span></span><span class=\"mord\">âˆ£</span><span class=\"mord text\"><span class=\"mord\">impression</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">click</span></span><span class=\"mord\">âˆ£</span><span class=\"mord text\"><span class=\"mord\">impression</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">conversion</span></span><span class=\"mord\">âˆ£</span><span class=\"mord text\"><span class=\"mord\">click</span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mi>C</mi><mi>T</mi><mi>C</mi><mi>V</mi><mi>R</mi><mo>=</mo><mi>p</mi><mi>C</mi><mi>T</mi><mi>R</mi><mo>Ã—</mo><mi>p</mi><mi>C</mi><mi>V</mi><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">pCTCVR = pCTR \\times pCVR \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">pCTC</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">pCTR</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">pC</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span></p>\n<p>æ¨¡å‹é€šè¿‡æ„å»ºä¸¤ä¸ªç‹¬ç«‹çš„é¢„æµ‹å¡”ï¼ˆä¸€ä¸ªé¢„æµ‹pCTRï¼Œä¸€ä¸ªé¢„æµ‹pCVRï¼‰ï¼Œå¹¶å…±äº«åº•å±‚çš„ç‰¹å¾åµŒå…¥ã€‚å…³é”®åœ¨äºï¼ŒpCVRå¡”çš„è®­ç»ƒä¿¡å·æ¥è‡ªäºpCTCVRçš„é¢„æµ‹ç»“æœï¼Œä»è€Œå·§å¦™åœ°è§£å†³äº†ç›´æ¥å¯¹CVRå»ºæ¨¡æ—¶å­˜åœ¨çš„<strong>æ ·æœ¬é€‰æ‹©åå·®</strong>ï¼ˆåªæœ‰ç‚¹å‡»æ ·æœ¬æ‰æœ‰è½¬åŒ–æ ‡ç­¾ï¼‰å’Œ<strong>æ•°æ®ç¨€ç–</strong>é—®é¢˜ã€‚</p>\n<h2 id=\"ğŸ“–-å»¶ä¼¸é˜…è¯»\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸ“–-å»¶ä¼¸é˜…è¯»\"><span>ğŸ“– å»¶ä¼¸é˜…è¯»</span></a></h2>\n<ol>\n<li><a href=\"https://arxiv.org/abs/1606.07792\" target=\"_blank\" rel=\"noopener noreferrer\">Wide &amp; Deep Learning for Recommender Systems (DLRS'16)</a> - æ·±åº¦å­¦ä¹ æ¨èçš„å¼€å±±ä¹‹ä½œã€‚</li>\n<li><a href=\"https://arxiv.org/abs/1703.04247\" target=\"_blank\" rel=\"noopener noreferrer\">DeepFM: A Factorization-Machine based Neural Network for CTR Prediction (IJCAI'17)</a> - ä¼˜é›…åœ°ç»Ÿä¸€äº†ä½é˜¶å’Œé«˜é˜¶ç‰¹å¾äº¤å‰ã€‚</li>\n<li><a href=\"https://arxiv.org/abs/1706.06978\" target=\"_blank\" rel=\"noopener noreferrer\">Deep Interest Network for Click-Through Rate Prediction (KDD'18)</a> - å°†æ³¨æ„åŠ›æœºåˆ¶æˆåŠŸå¼•å…¥æ¨èé¢†åŸŸã€‚</li>\n<li><a href=\"https://arxiv.org/abs/1804.07931\" target=\"_blank\" rel=\"noopener noreferrer\">Entire Space Multi-Task Model: An Effective Approach for Estimating Post-Click Conversion Rate (SIGIR'18)</a> - å¤šä»»åŠ¡å­¦ä¹ çš„ç»å…¸èŒƒå¼ã€‚</li>\n</ol>\n<blockquote>\n<p>ğŸ§  <strong>æ€è€ƒé¢˜</strong></p>\n<ol>\n<li><strong>ç‰¹å¾é€‰æ‹©</strong>ï¼šåœ¨è®¾è®¡Wide &amp; Deepæ¨¡å‹æ—¶ï¼Œä½ ä¼šå¦‚ä½•åˆ’åˆ†ç‰¹å¾è¿›å…¥Wideéƒ¨åˆ†å’ŒDeepéƒ¨åˆ†ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜å¹¶é™ˆè¿°ä½ çš„ç†ç”±ã€‚</li>\n<li><strong>å†·å¯åŠ¨é—®é¢˜</strong>ï¼šå¯¹äºä¸€ä¸ªæ²¡æœ‰ä»»ä½•å†å²è¡Œä¸ºçš„æ–°ç”¨æˆ·ï¼Œä½ è®¤ä¸ºDeepFMå’ŒDINå“ªä¸ªæ¨¡å‹èƒ½æ›´å¥½åœ°å¤„ç†ä»–çš„æ¨èè¯·æ±‚ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>\n<li><strong>æ³¨æ„åŠ›å¤±æ•ˆ</strong>ï¼šåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä½ è®¤ä¸ºDINçš„æ³¨æ„åŠ›æœºåˆ¶å¯èƒ½ä¼š&quot;å¤±æ•ˆ&quot;æˆ–è€…è¯´ä¸èµ·ä½œç”¨ï¼Ÿï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·çš„è¡Œä¸ºåºåˆ—éå¸¸çŸ­ï¼Œæˆ–è€…è¡Œä¸ºéå¸¸å•ä¸€ï¼‰</li>\n<li><strong>å¤šä»»åŠ¡çš„æŒ‘æˆ˜</strong>ï¼šé™¤äº†ESMMï¼Œä½ è¿˜èƒ½æƒ³åˆ°å“ªäº›æ–¹æ³•æ¥è§£å†³å¤šä»»åŠ¡å­¦ä¹ ä¸­å¯èƒ½å‡ºç°çš„&quot;è··è··æ¿æ•ˆåº”&quot;ï¼ˆå³ä¸€ä¸ªä»»åŠ¡æ€§èƒ½æå‡ï¼Œå¦ä¸€ä¸ªä»»åŠ¡æ€§èƒ½ä¸‹é™ï¼‰ï¼Ÿï¼ˆæç¤ºï¼šå¯ä»¥æ€è€ƒMMoEç­‰æ¨¡å‹ï¼‰</li>\n<li><strong>è¶…è¶ŠID</strong>ï¼šæœ¬ç« è®¨è®ºçš„æ¨¡å‹ä¸»è¦åŸºäºç”¨æˆ·çš„è¡Œä¸ºIDåºåˆ—ã€‚å¦‚æœä½ çš„ç‰©å“æœ‰ä¸°å¯Œçš„æ–‡æœ¬æˆ–å›¾åƒå†…å®¹ï¼Œä½ ä¼šå¦‚ä½•æ”¹é€ è¿™äº›æ¨¡å‹æ¥åˆ©ç”¨è¿™äº›å¤šæ¨¡æ€ä¿¡æ¯ï¼Ÿ</li>\n</ol>\n</blockquote>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">ğŸ‰ ç« èŠ‚å°ç»“</p>\n<p>æ·±åº¦å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„&quot;æ–‡è‰ºå¤å…´&quot;ï¼Œæœ¬è´¨ä¸Šæ˜¯ä»æ‰‹å·¥ç‰¹å¾å·¥ç¨‹å‘è‡ªåŠ¨è¡¨ç¤ºå­¦ä¹ çš„èŒƒå¼è½¬å˜ã€‚Wide &amp; Deepå¼€å¯äº†è®°å¿†ä¸æ³›åŒ–å¹¶é‡çš„æ—¶ä»£ï¼ŒDeepFMå®ç°äº†çœŸæ­£çš„ç«¯åˆ°ç«¯å­¦ä¹ ï¼ŒDINåˆ™è®©æˆ‘ä»¬ç†è§£äº†ç”¨æˆ·å…´è¶£çš„åŠ¨æ€æ€§ã€‚è¿™åœºé©å‘½ä¸ä»…è§£æ”¾äº†ç®—æ³•å·¥ç¨‹å¸ˆçš„åŒæ‰‹ï¼Œæ›´é‡è¦çš„æ˜¯è®©æ¨èç³»ç»Ÿå…·å¤‡äº†ç†è§£å¤æ‚ç”¨æˆ·è¡Œä¸ºæ¨¡å¼çš„èƒ½åŠ›ã€‚ä»é™æ€ç”»åƒåˆ°åŠ¨æ€æ„å›¾ï¼Œä»å•ä¸€ç›®æ ‡åˆ°å¤šä»»åŠ¡ä¼˜åŒ–ï¼Œæ·±åº¦å­¦ä¹ ä¸ºæ¨èç³»ç»Ÿæ³¨å…¥äº†å‰æ‰€æœªæœ‰çš„æ™ºèƒ½ã€‚</p>\n</div>\n<hr>\n<blockquote>\n<p>&quot;The best way to predict the future is to invent it.&quot; â€”â€” Alan Kay<br>\næ·±åº¦å­¦ä¹ ä¸ä»…é¢„æµ‹äº†æ¨èç³»ç»Ÿçš„æœªæ¥ï¼Œæ›´æ˜¯äº²æ‰‹åˆ›é€ äº†è¿™ä¸ªæ™ºèƒ½åŒ–çš„æœªæ¥ã€‚</p>\n</blockquote>\n","env":{"base":"/search-rec-ads-cosmos-explorer/","filePath":"D:/softwore/user/git/work_code/WeBotDoc/docs/zh/3.ç¬¬ä¸‰ç« ï¼šæ¨èç®—æ³•--æ¯”ä½ æ›´æ‡‚ä½ çš„è´´å¿ƒå°æ£‰è¢„/2.æ·±åº¦å­¦ä¹ æ–‡è‰ºå¤å…´/1.intro.md","filePathRelative":"zh/3.ç¬¬ä¸‰ç« ï¼šæ¨èç®—æ³•--æ¯”ä½ æ›´æ‡‚ä½ çš„è´´å¿ƒå°æ£‰è¢„/2.æ·±åº¦å­¦ä¹ æ–‡è‰ºå¤å…´/1.intro.md","frontmatter":{"title":"æ·±åº¦å­¦ä¹ åœ¨æ¨èä¸­çš„'æ–‡è‰ºå¤å…´'","createTime":"2025/06/05 09:34:56"},"sfcBlocks":{"template":{"type":"template","content":"<template><p>åœ¨æ·±åº¦å­¦ä¹ æµªæ½®å¸­å·äººå·¥æ™ºèƒ½çš„å„ä¸ªé¢†åŸŸä¹‹å‰ï¼Œæ¨èç³»ç»Ÿç”±ååŒè¿‡æ»¤ã€é€»è¾‘å›å½’ï¼ˆLRï¼‰å’Œå› å­åˆ†è§£æœºï¼ˆFMï¼‰ç­‰æ¨¡å‹ä¸»å¯¼ã€‚è¿™äº›æ¨¡å‹ç®€æ´ã€æœ‰æ•ˆï¼Œä½†å®ƒä»¬å…±åŒçš„&quot;é˜¿å–€ç‰æ–¯ä¹‹è¸µ&quot;æ˜¯â€”â€”<strong>ç‰¹å¾å·¥ç¨‹ï¼ˆFeature Engineeringï¼‰</strong>ã€‚ç®—æ³•å·¥ç¨‹å¸ˆä»¬å¦‚åŒæ‰‹å·¥è‰ºäººï¼Œéœ€è¦å‡­å€Ÿå¤§é‡çš„é¢†åŸŸçŸ¥è¯†ã€ç»éªŒå’Œç›´è§‰ï¼Œæ‰‹åŠ¨è®¾è®¡æœ‰æ•ˆçš„äº¤å‰ç‰¹å¾ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè€Œä¸”å¾€å¾€éš¾ä»¥å‘æ˜å‡ºæ•°æ®ä¸­é‚£äº›&quot;åç›´è§‰&quot;çš„éšè—æ¨¡å¼ã€‚</p>\n<p>2016å¹´ï¼ŒGoogleä¸€ç¯‡ã€ŠWide &amp; Deep Learning for Recommender Systemsã€‹æ¨ªç©ºå‡ºä¸–ï¼Œå¦‚åŒä¸€å£°å·è§’ï¼Œæ­£å¼å®£å‘Šäº†æ¨èç³»ç»Ÿ&quot;æ–‡è‰ºå¤å…´&quot;æ—¶ä»£çš„åˆ°æ¥ã€‚è¿™åœºå¤å…´çš„æ ¸å¿ƒï¼Œæ­£æ˜¯<strong>ç”¨æ·±åº¦å­¦ä¹ å®ç°&quot;ç«¯åˆ°ç«¯&quot;çš„è‡ªåŠ¨åŒ–ç‰¹å¾å­¦ä¹ </strong>ï¼Œå°†å·¥ç¨‹å¸ˆä»ç¹é‡çš„ä½“åŠ›åŠ³åŠ¨ä¸­è§£æ”¾å‡ºæ¥ï¼Œå»æ¢ç´¢æ›´å¹¿é˜”çš„æ¨¡å‹ç»“æ„å’Œä¸šåŠ¡è¾¹ç•Œã€‚</p>\n<h2 id=\"ğŸš€-èŒƒå¼é©å‘½-ä»-ç‰¹å¾å·¥ç¨‹-åˆ°-è¡¨ç¤ºå­¦ä¹ \" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸš€-èŒƒå¼é©å‘½-ä»-ç‰¹å¾å·¥ç¨‹-åˆ°-è¡¨ç¤ºå­¦ä¹ \"><span>ğŸš€ èŒƒå¼é©å‘½ï¼šä»&quot;ç‰¹å¾å·¥ç¨‹&quot;åˆ°&quot;è¡¨ç¤ºå­¦ä¹ &quot;</span></a></h2>\n<p>æ·±åº¦å­¦ä¹ å¸¦æ¥çš„é©å‘½ï¼Œå…¶æœ¬è´¨æ˜¯ <strong>è¡¨ç¤ºå­¦ä¹ ï¼ˆRepresentation Learningï¼‰</strong> ä»£æ›¿äº†æ‰‹å·¥ç‰¹å¾å·¥ç¨‹ã€‚</p>\n<ul>\n<li><strong>æ—§èŒƒå¼</strong>ï¼š<code v-pre>åŸå§‹æ•°æ® -&gt; äººå·¥ç‰¹å¾å·¥ç¨‹ -&gt; ç®€å•æ¨¡å‹ï¼ˆå¦‚LRï¼‰ -&gt; é¢„æµ‹</code></li>\n<li><strong>æ–°èŒƒå¼</strong>ï¼š<code v-pre>åŸå§‹æ•°æ® -&gt; è‡ªåŠ¨è¡¨ç¤ºå­¦ä¹ ï¼ˆEmbeddingï¼‰ -&gt; å¤æ‚æ¨¡å‹ï¼ˆå¦‚DNNï¼‰ -&gt; é¢„æµ‹</code></li>\n</ul>\n<p><strong>åµŒå…¥ï¼ˆEmbeddingï¼‰</strong> æ˜¯è¿™åœºé©å‘½çš„åŸºçŸ³ã€‚å®ƒå°†æ¯ä¸€ä¸ªåŸå§‹ã€é«˜ç»´ã€ç¨€ç–çš„ç‰¹å¾ï¼ˆå¦‚æ¯ä¸€ä¸ª<code v-pre>user_id</code>æˆ–<code v-pre>item_id</code>ï¼‰ï¼Œæ˜ å°„åˆ°ä¸€ä¸ªä½ç»´ã€ç¨ å¯†çš„å‘é‡ç©ºé—´ä¸­ã€‚åœ¨è¿™ä¸ªç¥å¥‡çš„ç©ºé—´é‡Œï¼Œç›¸ä¼¼çš„ç‰©å“æˆ–ç”¨æˆ·åœ¨è·ç¦»ä¸Šä¼šæ›´æ¥è¿‘ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™äº›åµŒå…¥å‘é‡æˆä¸ºäº†ç¥ç»ç½‘ç»œçš„&quot;é€šç”¨è¯­è¨€&quot;ï¼Œä½¿å¾—ç«¯åˆ°ç«¯çš„å­¦ä¹ æˆä¸ºå¯èƒ½ã€‚</p>\n<Mermaid id=\"mermaid-27\" code=\"eJxLL0osyFAIceFSAILi0iQIX+nZ9OUvepqf7ul/v2fW886dT/c1Pt2+9PmKbiWwOhBIySxKTS7JzM9T8AmCCzpGP+2b/3R5t6dLrIKurp2CU7USsm6bpCJ9O43UdCuFxPTU+PTUvJTUIh2FzJLU3PjkxJJUTaVasC7naJ8gfTffWLCxQEVc6I6btgHuuBcLVzxfsuvp2mVPdi4g4DgXNMe5Viu55ialpqRk5qU/3dgEcdyL9lVPu1ZAzIO5xy36+YoFT9e3PZ0w8WV7P0Sze7SLnx/ChSAaTDiDZQOiXy5qeba1G6LAHSLGBQDLmov3\"></Mermaid><h2 id=\"ğŸ¯-æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸ¯-æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯\"><span>ğŸ¯ æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯</span></a></h2>\n<p>æ·±åº¦å­¦ä¹ æ¨èæ¨¡å‹çš„æ¼”è¿›ï¼Œæ¸…æ™°åœ°åæ˜ äº†ä¸šç•Œå¯¹&quot;è®°å¿†&quot;ä¸&quot;æ³›åŒ–&quot;èƒ½åŠ›ã€ä»¥åŠå¯¹ç”¨æˆ·å…´è¶£ç†è§£æ·±åº¦çš„ä¸æ–­è¿½æ±‚ã€‚</p>\n<h3 id=\"_1-wide-deep-è®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-wide-deep-è®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹\"><span>1. Wide &amp; Deepï¼šè®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹</span></a></h3>\n<p>Wide &amp; Deepæ¨¡å‹çš„è®¾è®¡å“²å­¦å……æ»¡äº†æ™ºæ…§çš„å¹³è¡¡ã€‚å®ƒæ²¡æœ‰å®Œå…¨æŠ›å¼ƒä¼ ç»Ÿæ–¹æ³•çš„ä¼˜ç‚¹ï¼Œè€Œæ˜¯å°†ä¸¤è€…å·§å¦™åœ°ç»“åˆèµ·æ¥ï¼Œæ˜¯&quot;æ‰¿å‰å¯å&quot;çš„ç»å…¸ä¹‹ä½œã€‚</p>\n<ul>\n<li><strong>Wideéƒ¨åˆ†ï¼ˆè®°å¿†ï¼‰</strong>ï¼šæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¹¿ä¹‰çº¿æ€§æ¨¡å‹ã€‚å®ƒè´Ÿè´£&quot;è®°å¿†&quot;é‚£äº›åœ¨å†å²æ•°æ®ä¸­è¢«åå¤éªŒè¯è¿‡çš„ã€é‡è¦çš„ã€æ˜¾å¼çš„äº¤å‰ç‰¹å¾ã€‚ä¾‹å¦‚ï¼Œ<code v-pre>AND(user_gender=female, item_category=cosmetics)</code> è¿™ç§å¼ºå…±ç°è§„åˆ™ï¼Œå¯ä»¥è¢«Wideéƒ¨åˆ†å¿«é€Ÿã€ç²¾å‡†åœ°è®°ä½ã€‚è¿™éƒ¨åˆ†é€šå¸¸ä½¿ç”¨éœ€è¦äººå·¥è®¾è®¡çš„ç¨€ç–äº¤å‰ç‰¹å¾ã€‚</li>\n<li><strong>Deepéƒ¨åˆ†ï¼ˆæ³›åŒ–ï¼‰</strong>ï¼šæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆDNNï¼‰ã€‚å®ƒè´Ÿè´£&quot;æ³›åŒ–&quot;ï¼Œé€šè¿‡ç‰¹å¾çš„å¤šæ¬¡éçº¿æ€§å˜æ¢ï¼Œæ¢ç´¢é‚£äº›ä»æœªæˆ–å¾ˆå°‘åœ¨å†å²ä¸­å‡ºç°è¿‡çš„ã€æ½œåœ¨çš„ç‰¹å¾ç»„åˆã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨æˆ·ä»æœªä¹°è¿‡&quot;å¸å¦†æ°´&quot;ï¼Œä½†Deepæ¨¡å‹å¯ä»¥æ ¹æ®å¥¹è´­ä¹°&quot;ç²‰åº•æ¶²&quot;å’Œ&quot;çœ¼å½±&quot;çš„è¡Œä¸ºï¼Œæ³›åŒ–å‡ºå¥¹å¯¹&quot;å¸å¦†æ°´&quot;çš„æ½œåœ¨å…´è¶£ã€‚è¿™éƒ¨åˆ†é€šå¸¸ä½¿ç”¨ç”¨æˆ·çš„ç”»åƒç‰¹å¾å’Œç‰©å“çš„å±æ€§ç‰¹å¾ã€‚</li>\n</ul>\n<p><strong>æœ€ç»ˆé¢„æµ‹æ˜¯ä¸¤éƒ¨åˆ†çš„åŠ æƒå’Œ</strong>ï¼Œå†é€šè¿‡Sigmoidå‡½æ•°è¾“å‡ºï¼š\n<span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">âˆ£</mi><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">w</mi><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow><mi>T</mi></msubsup><mi mathvariant=\"bold\">x</mi><mo>+</mo><msubsup><mi mathvariant=\"bold\">w</mi><mrow><mi>d</mi><mi>e</mi><mi>e</mi><mi>p</mi></mrow><mi>T</mi></msubsup><msup><mi mathvariant=\"bold\">a</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>l</mi><mi>f</mi></msub><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[ P(Y=1|\\mathbf{x}) = \\sigma(\\mathbf{w}_{wide}^T \\mathbf{x} + \\mathbf{w}_{deep}^T \\mathbf{a}^{(l_f)} + b) ]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1âˆ£</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1244em;vertical-align:-0.2831em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4169em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3072em;vertical-align:-0.4192em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4169em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">ee</span><span class=\"mord mathnormal mtight\">p</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4192em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2901em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)]</span></span></span></span></p>\n<details class=\"hint-container details\"><summary>Wide &amp; Deep æ ¸å¿ƒé€»è¾‘å®ç°</summary>\n<div class=\"language-python line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"python\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-python\"><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">from</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ...</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">basic</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">layers </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"--shiki-light:#2E8F82;--shiki-dark:#5DA994\"> WideDeep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nn</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Module</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Wide &#x26; Deep Learning model.</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">    Args:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        wide_features (list): the list of `Feature Class`, training by the wide part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        deep_features (list): the list of `Feature Class`, training by the deep part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        mlp_params (dict): the params of the last MLP module, keys include:`{\"dims\":list, \"activation\":str, \"dropout\":float, \"output_layer\":bool`}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> wide_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">        super</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">WideDeep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">).</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">__init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> wide_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> wide_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_features </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> **</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> forward</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_wide </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, wide_dims]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, deep_dims]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_wide </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_wide</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, 1]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_deep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, 1]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_wide </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_deep</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sigmoid</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">y</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">squeeze</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></details>\n<h3 id=\"_2-deepfm-ç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-deepfm-ç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰\"><span>2. DeepFMï¼šç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰</span></a></h3>\n<p>Wide &amp; Deepè™½ç„¶å¼ºå¤§ï¼Œä½†å®ƒçš„Wideéƒ¨åˆ†ä»ç„¶ä¾èµ–äººå·¥è®¾è®¡ç‰¹å¾ï¼Œæœªèƒ½å®Œå…¨å®ç°ç«¯åˆ°ç«¯ã€‚<strong>DeepFM (Deep Factorization Machine)</strong> çš„å‡ºç°ï¼Œä¼˜é›…åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>DeepFMçš„æ ¸å¿ƒåˆ›æ–°åœ¨äºï¼š<strong>å®ƒå°†Wideéƒ¨åˆ†æ›¿æ¢ä¸ºäº†ä¸€ä¸ªå› å­åˆ†è§£æœºï¼ˆFMï¼‰</strong>ï¼Œå¹¶ä¸”è¿™ä¸ªFMç»„ä»¶ä¸Deepç»„ä»¶<strong>å…±äº«åŒä¸€å¥—è¾“å…¥åµŒå…¥</strong>ã€‚</p>\n<ul>\n<li><strong>FMç»„ä»¶</strong>ï¼šè´Ÿè´£å­¦ä¹ <strong>ä¸€é˜¶å’ŒäºŒé˜¶ç‰¹å¾äº¤å‰</strong>ã€‚å®ƒèƒ½åƒ<code v-pre>Wide</code>éƒ¨åˆ†ä¸€æ ·æ•æ‰ç‰¹å¾çš„ç›´æ¥å…³è”ï¼Œä½†æ— éœ€äººå·¥è®¾è®¡ã€‚ä¾‹å¦‚ï¼Œ<code v-pre>user_id</code>çš„åµŒå…¥å’Œ<code v-pre>item_id</code>çš„åµŒå…¥å‘é‡åšå†…ç§¯ï¼Œå°±è‡ªåŠ¨åœ°å­¦ä¹ äº†è¿™å¯¹IDçš„äºŒé˜¶äº¤å‰ç‰¹å¾ã€‚</li>\n<li><strong>Deepç»„ä»¶</strong>ï¼šä¸Wide &amp; Deepä¸­çš„Deepéƒ¨åˆ†å®Œå…¨ä¸€æ ·ï¼Œè´Ÿè´£å­¦ä¹ <strong>é«˜é˜¶çš„ã€éšå«çš„ç‰¹å¾äº¤å‰</strong>ã€‚</li>\n</ul>\n<p>è¿™ç§å…±äº«åµŒå…¥çš„æ¶æ„å¸¦æ¥äº†ä¸¤å¤§å¥½å¤„ï¼š</p>\n<ol>\n<li><strong>ç«¯åˆ°ç«¯è®­ç»ƒ</strong>ï¼šä¸å†éœ€è¦ä»»ä½•äººå·¥ç‰¹å¾å·¥ç¨‹ã€‚</li>\n<li><strong>æ•ˆç‡ä¸æ•ˆæœ</strong>ï¼šæ¨¡å‹ä»åŸå§‹ç‰¹å¾ä¸­åŒæ—¶å­¦ä¹ äº†ä¸€é˜¶ã€äºŒé˜¶å’Œé«˜é˜¶çš„äº¤å‰ï¼Œæ•ˆæœæ›´å¥½ï¼Œä¸”å‚æ•°å…±äº«ä½¿å¾—è®­ç»ƒæ›´é«˜æ•ˆã€‚</li>\n</ol>\n<details class=\"hint-container details\"><summary>DeepFM æ ¸å¿ƒé€»è¾‘å®ç°</summary>\n<div class=\"language-python line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"python\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-python\"><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">from</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ...</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">basic</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">layers </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> FM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"--shiki-light:#2E8F82;--shiki-dark:#5DA994\"> DeepFM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nn</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Module</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Deep Factorization Machine Model</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">    Args:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        deep_features (list): the list of `Feature Class`, training by the deep part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        fm_features (list): the list of `Feature Class`, training by the fm part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        mlp_params (dict): the params of the last MLP module, keys include:`{\"dims\":list, \"activation\":str, \"dropout\":float, \"output_layer\":bool`}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">        super</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">DeepFM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">).</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">__init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 1-odrder interaction</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> FM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">reduce_sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 2-odrder interaction</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> **</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> forward</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, deep_dims]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_fm </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">False</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, num_fields, embed_dim]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_linear </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_fm</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">flatten</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">start_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_fm </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_fm</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_deep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, 1]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_linear </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_fm </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_deep</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sigmoid</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">y</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">squeeze</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></details>\n<h3 id=\"_3-din-æ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-din-æ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£\"><span>3. DINï¼šæ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£</span></a></h3>\n<p>æ— è®ºæ˜¯Wide&amp;Deepè¿˜æ˜¯DeepFMï¼Œå®ƒä»¬åœ¨å¤„ç†ç”¨æˆ·å†å²è¡Œä¸ºæ—¶ï¼Œé€šå¸¸åªæ˜¯å°†è¡Œä¸ºåºåˆ—çš„åµŒå…¥å‘é‡è¿›è¡Œç®€å•çš„æ± åŒ–ï¼ˆå¦‚æ±‚å’Œæˆ–å¹³å‡ï¼‰ï¼Œè¿™ç­‰äºæŠŠç”¨æˆ·ä¸°å¯Œå¤šå½©çš„å…´è¶£ï¼ˆå¦‚&quot;çˆ±çœ‹ç¯®çƒ&quot;ã€&quot;åˆšä¹°äº†ç›¸æœº&quot;ã€&quot;æœ€è¿‘åœ¨å¬å¤å…¸ä¹&quot;ï¼‰å‹ç¼©æˆäº†ä¸€ä¸ªæ¨¡ç³Šçš„å¹³å‡å…´è¶£ã€‚</p>\n<p><strong>DIN (Deep Interest Network)</strong> é©å‘½æ€§åœ°æŒ‡å‡ºï¼š<strong>ç”¨æˆ·çš„å…´è¶£æ˜¯åŠ¨æ€çš„ï¼Œåº”è¯¥æ ¹æ®å½“å‰çš„&quot;ç›®æ ‡&quot;æ¥å†³å®šå…³æ³¨å†å²ä¸­çš„å“ªéƒ¨åˆ†ä¿¡æ¯ã€‚</strong> å½“å‘ä¸€ä¸ªç”¨æˆ·æ¨è&quot;ç¯®çƒé‹&quot;æ—¶ï¼Œä»–æœ€è¿‘æµè§ˆ&quot;ç¯®çƒæ¯”èµ›&quot;çš„è¡Œä¸ºå°±åº”è¯¥æ¯”ä»–ä¸Šå‘¨è´­ä¹°&quot;ç›¸æœº&quot;çš„è¡Œä¸ºè·å¾—æ›´é«˜çš„æƒé‡ã€‚</p>\n<p>DINä¸ºæ­¤è®¾è®¡äº†<strong>æ³¨æ„åŠ›æœºåˆ¶ï¼ˆAttention Mechanismï¼‰</strong>ï¼š</p>\n<ul>\n<li>å®ƒå°†<strong>å€™é€‰ç‰©å“ï¼ˆTarget Itemï¼‰</strong> ä½œä¸º&quot;æŸ¥è¯¢ï¼ˆQueryï¼‰&quot;ã€‚</li>\n<li>å°†ç”¨æˆ·çš„<strong>å†å²è¡Œä¸ºåºåˆ—ï¼ˆHistory Behaviorsï¼‰</strong> ä½œä¸º&quot;é”®ï¼ˆKeysï¼‰&quot;å’Œ&quot;å€¼ï¼ˆValuesï¼‰&quot;ã€‚</li>\n<li>é€šè¿‡ä¸€ä¸ª&quot;æ³¨æ„åŠ›æ¿€æ´»å•å…ƒ&quot;ï¼ˆæœ¬è´¨æ˜¯ä¸ªå°å‹MLPï¼‰ï¼Œè®¡ç®—å€™é€‰ç‰©å“ä¸æ¯ä¸€æ¡å†å²è¡Œä¸ºçš„&quot;ç›¸å…³æ€§å¾—åˆ†&quot;ã€‚</li>\n<li>æœ€åï¼Œç”¨è¿™äº›å¾—åˆ†ä½œä¸ºæƒé‡ï¼Œå¯¹å†å²è¡Œä¸ºåºåˆ—çš„åµŒå…¥è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°ä¸€ä¸ªä¸ºå½“å‰å€™é€‰ç‰©å“&quot;é‡èº«å®šåˆ¶&quot;çš„ç”¨æˆ·å…´è¶£è¡¨ç¤ºã€‚</li>\n</ul>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>UserInterest</mtext><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">c</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msub><mi>Î±</mi><mi>i</mi></msub><mo>â‹…</mo><msub><mi mathvariant=\"bold\">h</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mtext>attention</mtext><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">c</mi><mo separator=\"true\">,</mo><msub><mi mathvariant=\"bold\">h</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>â‹…</mo><msub><mi mathvariant=\"bold\">h</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\text{UserInterest}(\\mathbf{c}) = \\sum_{i=1}^{T} \\alpha_i \\cdot \\mathbf{h}_i = \\sum_{i=1}^{T} \\text{attention}(\\mathbf{c}, \\mathbf{h}_i) \\cdot \\mathbf{h}_i \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">UserInterest</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">attention</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">c</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>DINæ ‡å¿—ç€æ¨èæ¨¡å‹ä»å¯¹&quot;é™æ€ç”¨æˆ·ç”»åƒ&quot;çš„ç†è§£ï¼Œè¿ˆå‘äº†å¯¹&quot;åŠ¨æ€ç”¨æˆ·æ„å›¾&quot;çš„æ•æ‰ã€‚</p>\n<h2 id=\"ğŸ™ï¸-åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§-å¤šä»»åŠ¡å­¦ä¹ \" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸ™ï¸-åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§-å¤šä»»åŠ¡å­¦ä¹ \"><span>ğŸ™ï¸ åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§ï¼šå¤šä»»åŠ¡å­¦ä¹ </span></a></h2>\n<p>åœ¨çœŸå®çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¸åªå…³å¿ƒ<strong>ç‚¹å‡»ç‡ï¼ˆCTRï¼‰</strong>ï¼Œè¿˜å…³å¿ƒ<strong>è½¬åŒ–ç‡ï¼ˆCVRï¼‰</strong>ã€<strong>è§‚çœ‹æ—¶é•¿</strong>ã€<strong>åˆ†äº«ç‡</strong>ç­‰å¤šä¸ªæŒ‡æ ‡ã€‚å¤šä»»åŠ¡å­¦ä¹ ï¼ˆMulti-Task Learning, MTLï¼‰å°±æ˜¯ä¸ºäº†åŒæ—¶ä¼˜åŒ–è¿™äº›ç›®æ ‡è€Œè®¾è®¡çš„ã€‚</p>\n<p>æœ€ç»å…¸çš„æ¨¡å‹ä¹‹ä¸€æ˜¯ <strong>ESMM (Entire Space Multi-task Model)</strong>ï¼Œå®ƒå·§å¦™åœ°åˆ©ç”¨äº†ä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»ã€‚åœ¨ç”µå•†åœºæ™¯ä¸­ï¼Œç”¨æˆ·å¿…é¡»å…ˆ&quot;ç‚¹å‡»&quot;å•†å“ï¼Œæ‰å¯èƒ½&quot;è´­ä¹°&quot;å•†å“ã€‚å› æ­¤ï¼Œè½¬åŒ–ï¼ˆPurchaseï¼‰è¡Œä¸ºå¿…ç„¶å‘ç”Ÿåœ¨ç‚¹å‡»ï¼ˆClickï¼‰è¡Œä¸ºä¹‹åã€‚ESMMåˆ©ç”¨è¿™ä¸ªå…³ç³»ï¼Œå°†é¢„æµ‹ç›®æ ‡åˆ†è§£ä¸ºï¼š</p>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>conversion</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>impression</mtext><mo stretchy=\"false\">)</mo><mo>=</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>click</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>impression</mtext><mo stretchy=\"false\">)</mo><mo>Ã—</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>conversion</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>click</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\text{conversion} | \\text{impression}) = p(\\text{click} | \\text{impression}) \\times p(\\text{conversion} | \\text{click}) \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">conversion</span></span><span class=\"mord\">âˆ£</span><span class=\"mord text\"><span class=\"mord\">impression</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">click</span></span><span class=\"mord\">âˆ£</span><span class=\"mord text\"><span class=\"mord\">impression</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">conversion</span></span><span class=\"mord\">âˆ£</span><span class=\"mord text\"><span class=\"mord\">click</span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mi>C</mi><mi>T</mi><mi>C</mi><mi>V</mi><mi>R</mi><mo>=</mo><mi>p</mi><mi>C</mi><mi>T</mi><mi>R</mi><mo>Ã—</mo><mi>p</mi><mi>C</mi><mi>V</mi><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">pCTCVR = pCTR \\times pCVR \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">pCTC</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">pCTR</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">pC</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span></p>\n<p>æ¨¡å‹é€šè¿‡æ„å»ºä¸¤ä¸ªç‹¬ç«‹çš„é¢„æµ‹å¡”ï¼ˆä¸€ä¸ªé¢„æµ‹pCTRï¼Œä¸€ä¸ªé¢„æµ‹pCVRï¼‰ï¼Œå¹¶å…±äº«åº•å±‚çš„ç‰¹å¾åµŒå…¥ã€‚å…³é”®åœ¨äºï¼ŒpCVRå¡”çš„è®­ç»ƒä¿¡å·æ¥è‡ªäºpCTCVRçš„é¢„æµ‹ç»“æœï¼Œä»è€Œå·§å¦™åœ°è§£å†³äº†ç›´æ¥å¯¹CVRå»ºæ¨¡æ—¶å­˜åœ¨çš„<strong>æ ·æœ¬é€‰æ‹©åå·®</strong>ï¼ˆåªæœ‰ç‚¹å‡»æ ·æœ¬æ‰æœ‰è½¬åŒ–æ ‡ç­¾ï¼‰å’Œ<strong>æ•°æ®ç¨€ç–</strong>é—®é¢˜ã€‚</p>\n<h2 id=\"ğŸ“–-å»¶ä¼¸é˜…è¯»\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸ“–-å»¶ä¼¸é˜…è¯»\"><span>ğŸ“– å»¶ä¼¸é˜…è¯»</span></a></h2>\n<ol>\n<li><a href=\"https://arxiv.org/abs/1606.07792\" target=\"_blank\" rel=\"noopener noreferrer\">Wide &amp; Deep Learning for Recommender Systems (DLRS'16)</a> - æ·±åº¦å­¦ä¹ æ¨èçš„å¼€å±±ä¹‹ä½œã€‚</li>\n<li><a href=\"https://arxiv.org/abs/1703.04247\" target=\"_blank\" rel=\"noopener noreferrer\">DeepFM: A Factorization-Machine based Neural Network for CTR Prediction (IJCAI'17)</a> - ä¼˜é›…åœ°ç»Ÿä¸€äº†ä½é˜¶å’Œé«˜é˜¶ç‰¹å¾äº¤å‰ã€‚</li>\n<li><a href=\"https://arxiv.org/abs/1706.06978\" target=\"_blank\" rel=\"noopener noreferrer\">Deep Interest Network for Click-Through Rate Prediction (KDD'18)</a> - å°†æ³¨æ„åŠ›æœºåˆ¶æˆåŠŸå¼•å…¥æ¨èé¢†åŸŸã€‚</li>\n<li><a href=\"https://arxiv.org/abs/1804.07931\" target=\"_blank\" rel=\"noopener noreferrer\">Entire Space Multi-Task Model: An Effective Approach for Estimating Post-Click Conversion Rate (SIGIR'18)</a> - å¤šä»»åŠ¡å­¦ä¹ çš„ç»å…¸èŒƒå¼ã€‚</li>\n</ol>\n<blockquote>\n<p>ğŸ§  <strong>æ€è€ƒé¢˜</strong></p>\n<ol>\n<li><strong>ç‰¹å¾é€‰æ‹©</strong>ï¼šåœ¨è®¾è®¡Wide &amp; Deepæ¨¡å‹æ—¶ï¼Œä½ ä¼šå¦‚ä½•åˆ’åˆ†ç‰¹å¾è¿›å…¥Wideéƒ¨åˆ†å’ŒDeepéƒ¨åˆ†ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜å¹¶é™ˆè¿°ä½ çš„ç†ç”±ã€‚</li>\n<li><strong>å†·å¯åŠ¨é—®é¢˜</strong>ï¼šå¯¹äºä¸€ä¸ªæ²¡æœ‰ä»»ä½•å†å²è¡Œä¸ºçš„æ–°ç”¨æˆ·ï¼Œä½ è®¤ä¸ºDeepFMå’ŒDINå“ªä¸ªæ¨¡å‹èƒ½æ›´å¥½åœ°å¤„ç†ä»–çš„æ¨èè¯·æ±‚ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>\n<li><strong>æ³¨æ„åŠ›å¤±æ•ˆ</strong>ï¼šåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä½ è®¤ä¸ºDINçš„æ³¨æ„åŠ›æœºåˆ¶å¯èƒ½ä¼š&quot;å¤±æ•ˆ&quot;æˆ–è€…è¯´ä¸èµ·ä½œç”¨ï¼Ÿï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·çš„è¡Œä¸ºåºåˆ—éå¸¸çŸ­ï¼Œæˆ–è€…è¡Œä¸ºéå¸¸å•ä¸€ï¼‰</li>\n<li><strong>å¤šä»»åŠ¡çš„æŒ‘æˆ˜</strong>ï¼šé™¤äº†ESMMï¼Œä½ è¿˜èƒ½æƒ³åˆ°å“ªäº›æ–¹æ³•æ¥è§£å†³å¤šä»»åŠ¡å­¦ä¹ ä¸­å¯èƒ½å‡ºç°çš„&quot;è··è··æ¿æ•ˆåº”&quot;ï¼ˆå³ä¸€ä¸ªä»»åŠ¡æ€§èƒ½æå‡ï¼Œå¦ä¸€ä¸ªä»»åŠ¡æ€§èƒ½ä¸‹é™ï¼‰ï¼Ÿï¼ˆæç¤ºï¼šå¯ä»¥æ€è€ƒMMoEç­‰æ¨¡å‹ï¼‰</li>\n<li><strong>è¶…è¶ŠID</strong>ï¼šæœ¬ç« è®¨è®ºçš„æ¨¡å‹ä¸»è¦åŸºäºç”¨æˆ·çš„è¡Œä¸ºIDåºåˆ—ã€‚å¦‚æœä½ çš„ç‰©å“æœ‰ä¸°å¯Œçš„æ–‡æœ¬æˆ–å›¾åƒå†…å®¹ï¼Œä½ ä¼šå¦‚ä½•æ”¹é€ è¿™äº›æ¨¡å‹æ¥åˆ©ç”¨è¿™äº›å¤šæ¨¡æ€ä¿¡æ¯ï¼Ÿ</li>\n</ol>\n</blockquote>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">ğŸ‰ ç« èŠ‚å°ç»“</p>\n<p>æ·±åº¦å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„&quot;æ–‡è‰ºå¤å…´&quot;ï¼Œæœ¬è´¨ä¸Šæ˜¯ä»æ‰‹å·¥ç‰¹å¾å·¥ç¨‹å‘è‡ªåŠ¨è¡¨ç¤ºå­¦ä¹ çš„èŒƒå¼è½¬å˜ã€‚Wide &amp; Deepå¼€å¯äº†è®°å¿†ä¸æ³›åŒ–å¹¶é‡çš„æ—¶ä»£ï¼ŒDeepFMå®ç°äº†çœŸæ­£çš„ç«¯åˆ°ç«¯å­¦ä¹ ï¼ŒDINåˆ™è®©æˆ‘ä»¬ç†è§£äº†ç”¨æˆ·å…´è¶£çš„åŠ¨æ€æ€§ã€‚è¿™åœºé©å‘½ä¸ä»…è§£æ”¾äº†ç®—æ³•å·¥ç¨‹å¸ˆçš„åŒæ‰‹ï¼Œæ›´é‡è¦çš„æ˜¯è®©æ¨èç³»ç»Ÿå…·å¤‡äº†ç†è§£å¤æ‚ç”¨æˆ·è¡Œä¸ºæ¨¡å¼çš„èƒ½åŠ›ã€‚ä»é™æ€ç”»åƒåˆ°åŠ¨æ€æ„å›¾ï¼Œä»å•ä¸€ç›®æ ‡åˆ°å¤šä»»åŠ¡ä¼˜åŒ–ï¼Œæ·±åº¦å­¦ä¹ ä¸ºæ¨èç³»ç»Ÿæ³¨å…¥äº†å‰æ‰€æœªæœ‰çš„æ™ºèƒ½ã€‚</p>\n</div>\n<hr>\n<blockquote>\n<p>&quot;The best way to predict the future is to invent it.&quot; â€”â€” Alan Kay<br>\næ·±åº¦å­¦ä¹ ä¸ä»…é¢„æµ‹äº†æ¨èç³»ç»Ÿçš„æœªæ¥ï¼Œæ›´æ˜¯äº²æ‰‹åˆ›é€ äº†è¿™ä¸ªæ™ºèƒ½åŒ–çš„æœªæ¥ã€‚</p>\n</blockquote>\n</template>","contentStripped":"<p>åœ¨æ·±åº¦å­¦ä¹ æµªæ½®å¸­å·äººå·¥æ™ºèƒ½çš„å„ä¸ªé¢†åŸŸä¹‹å‰ï¼Œæ¨èç³»ç»Ÿç”±ååŒè¿‡æ»¤ã€é€»è¾‘å›å½’ï¼ˆLRï¼‰å’Œå› å­åˆ†è§£æœºï¼ˆFMï¼‰ç­‰æ¨¡å‹ä¸»å¯¼ã€‚è¿™äº›æ¨¡å‹ç®€æ´ã€æœ‰æ•ˆï¼Œä½†å®ƒä»¬å…±åŒçš„&quot;é˜¿å–€ç‰æ–¯ä¹‹è¸µ&quot;æ˜¯â€”â€”<strong>ç‰¹å¾å·¥ç¨‹ï¼ˆFeature Engineeringï¼‰</strong>ã€‚ç®—æ³•å·¥ç¨‹å¸ˆä»¬å¦‚åŒæ‰‹å·¥è‰ºäººï¼Œéœ€è¦å‡­å€Ÿå¤§é‡çš„é¢†åŸŸçŸ¥è¯†ã€ç»éªŒå’Œç›´è§‰ï¼Œæ‰‹åŠ¨è®¾è®¡æœ‰æ•ˆçš„äº¤å‰ç‰¹å¾ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè€Œä¸”å¾€å¾€éš¾ä»¥å‘æ˜å‡ºæ•°æ®ä¸­é‚£äº›&quot;åç›´è§‰&quot;çš„éšè—æ¨¡å¼ã€‚</p>\n<p>2016å¹´ï¼ŒGoogleä¸€ç¯‡ã€ŠWide &amp; Deep Learning for Recommender Systemsã€‹æ¨ªç©ºå‡ºä¸–ï¼Œå¦‚åŒä¸€å£°å·è§’ï¼Œæ­£å¼å®£å‘Šäº†æ¨èç³»ç»Ÿ&quot;æ–‡è‰ºå¤å…´&quot;æ—¶ä»£çš„åˆ°æ¥ã€‚è¿™åœºå¤å…´çš„æ ¸å¿ƒï¼Œæ­£æ˜¯<strong>ç”¨æ·±åº¦å­¦ä¹ å®ç°&quot;ç«¯åˆ°ç«¯&quot;çš„è‡ªåŠ¨åŒ–ç‰¹å¾å­¦ä¹ </strong>ï¼Œå°†å·¥ç¨‹å¸ˆä»ç¹é‡çš„ä½“åŠ›åŠ³åŠ¨ä¸­è§£æ”¾å‡ºæ¥ï¼Œå»æ¢ç´¢æ›´å¹¿é˜”çš„æ¨¡å‹ç»“æ„å’Œä¸šåŠ¡è¾¹ç•Œã€‚</p>\n<h2 id=\"ğŸš€-èŒƒå¼é©å‘½-ä»-ç‰¹å¾å·¥ç¨‹-åˆ°-è¡¨ç¤ºå­¦ä¹ \" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸš€-èŒƒå¼é©å‘½-ä»-ç‰¹å¾å·¥ç¨‹-åˆ°-è¡¨ç¤ºå­¦ä¹ \"><span>ğŸš€ èŒƒå¼é©å‘½ï¼šä»&quot;ç‰¹å¾å·¥ç¨‹&quot;åˆ°&quot;è¡¨ç¤ºå­¦ä¹ &quot;</span></a></h2>\n<p>æ·±åº¦å­¦ä¹ å¸¦æ¥çš„é©å‘½ï¼Œå…¶æœ¬è´¨æ˜¯ <strong>è¡¨ç¤ºå­¦ä¹ ï¼ˆRepresentation Learningï¼‰</strong> ä»£æ›¿äº†æ‰‹å·¥ç‰¹å¾å·¥ç¨‹ã€‚</p>\n<ul>\n<li><strong>æ—§èŒƒå¼</strong>ï¼š<code v-pre>åŸå§‹æ•°æ® -&gt; äººå·¥ç‰¹å¾å·¥ç¨‹ -&gt; ç®€å•æ¨¡å‹ï¼ˆå¦‚LRï¼‰ -&gt; é¢„æµ‹</code></li>\n<li><strong>æ–°èŒƒå¼</strong>ï¼š<code v-pre>åŸå§‹æ•°æ® -&gt; è‡ªåŠ¨è¡¨ç¤ºå­¦ä¹ ï¼ˆEmbeddingï¼‰ -&gt; å¤æ‚æ¨¡å‹ï¼ˆå¦‚DNNï¼‰ -&gt; é¢„æµ‹</code></li>\n</ul>\n<p><strong>åµŒå…¥ï¼ˆEmbeddingï¼‰</strong> æ˜¯è¿™åœºé©å‘½çš„åŸºçŸ³ã€‚å®ƒå°†æ¯ä¸€ä¸ªåŸå§‹ã€é«˜ç»´ã€ç¨€ç–çš„ç‰¹å¾ï¼ˆå¦‚æ¯ä¸€ä¸ª<code v-pre>user_id</code>æˆ–<code v-pre>item_id</code>ï¼‰ï¼Œæ˜ å°„åˆ°ä¸€ä¸ªä½ç»´ã€ç¨ å¯†çš„å‘é‡ç©ºé—´ä¸­ã€‚åœ¨è¿™ä¸ªç¥å¥‡çš„ç©ºé—´é‡Œï¼Œç›¸ä¼¼çš„ç‰©å“æˆ–ç”¨æˆ·åœ¨è·ç¦»ä¸Šä¼šæ›´æ¥è¿‘ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™äº›åµŒå…¥å‘é‡æˆä¸ºäº†ç¥ç»ç½‘ç»œçš„&quot;é€šç”¨è¯­è¨€&quot;ï¼Œä½¿å¾—ç«¯åˆ°ç«¯çš„å­¦ä¹ æˆä¸ºå¯èƒ½ã€‚</p>\n<Mermaid id=\"mermaid-27\" code=\"eJxLL0osyFAIceFSAILi0iQIX+nZ9OUvepqf7ul/v2fW886dT/c1Pt2+9PmKbiWwOhBIySxKTS7JzM9T8AmCCzpGP+2b/3R5t6dLrIKurp2CU7USsm6bpCJ9O43UdCuFxPTU+PTUvJTUIh2FzJLU3PjkxJJUTaVasC7naJ8gfTffWLCxQEVc6I6btgHuuBcLVzxfsuvp2mVPdi4g4DgXNMe5Viu55ialpqRk5qU/3dgEcdyL9lVPu1ZAzIO5xy36+YoFT9e3PZ0w8WV7P0Sze7SLnx/ChSAaTDiDZQOiXy5qeba1G6LAHSLGBQDLmov3\"></Mermaid><h2 id=\"ğŸ¯-æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸ¯-æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯\"><span>ğŸ¯ æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯</span></a></h2>\n<p>æ·±åº¦å­¦ä¹ æ¨èæ¨¡å‹çš„æ¼”è¿›ï¼Œæ¸…æ™°åœ°åæ˜ äº†ä¸šç•Œå¯¹&quot;è®°å¿†&quot;ä¸&quot;æ³›åŒ–&quot;èƒ½åŠ›ã€ä»¥åŠå¯¹ç”¨æˆ·å…´è¶£ç†è§£æ·±åº¦çš„ä¸æ–­è¿½æ±‚ã€‚</p>\n<h3 id=\"_1-wide-deep-è®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-wide-deep-è®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹\"><span>1. Wide &amp; Deepï¼šè®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹</span></a></h3>\n<p>Wide &amp; Deepæ¨¡å‹çš„è®¾è®¡å“²å­¦å……æ»¡äº†æ™ºæ…§çš„å¹³è¡¡ã€‚å®ƒæ²¡æœ‰å®Œå…¨æŠ›å¼ƒä¼ ç»Ÿæ–¹æ³•çš„ä¼˜ç‚¹ï¼Œè€Œæ˜¯å°†ä¸¤è€…å·§å¦™åœ°ç»“åˆèµ·æ¥ï¼Œæ˜¯&quot;æ‰¿å‰å¯å&quot;çš„ç»å…¸ä¹‹ä½œã€‚</p>\n<ul>\n<li><strong>Wideéƒ¨åˆ†ï¼ˆè®°å¿†ï¼‰</strong>ï¼šæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¹¿ä¹‰çº¿æ€§æ¨¡å‹ã€‚å®ƒè´Ÿè´£&quot;è®°å¿†&quot;é‚£äº›åœ¨å†å²æ•°æ®ä¸­è¢«åå¤éªŒè¯è¿‡çš„ã€é‡è¦çš„ã€æ˜¾å¼çš„äº¤å‰ç‰¹å¾ã€‚ä¾‹å¦‚ï¼Œ<code v-pre>AND(user_gender=female, item_category=cosmetics)</code> è¿™ç§å¼ºå…±ç°è§„åˆ™ï¼Œå¯ä»¥è¢«Wideéƒ¨åˆ†å¿«é€Ÿã€ç²¾å‡†åœ°è®°ä½ã€‚è¿™éƒ¨åˆ†é€šå¸¸ä½¿ç”¨éœ€è¦äººå·¥è®¾è®¡çš„ç¨€ç–äº¤å‰ç‰¹å¾ã€‚</li>\n<li><strong>Deepéƒ¨åˆ†ï¼ˆæ³›åŒ–ï¼‰</strong>ï¼šæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆDNNï¼‰ã€‚å®ƒè´Ÿè´£&quot;æ³›åŒ–&quot;ï¼Œé€šè¿‡ç‰¹å¾çš„å¤šæ¬¡éçº¿æ€§å˜æ¢ï¼Œæ¢ç´¢é‚£äº›ä»æœªæˆ–å¾ˆå°‘åœ¨å†å²ä¸­å‡ºç°è¿‡çš„ã€æ½œåœ¨çš„ç‰¹å¾ç»„åˆã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨æˆ·ä»æœªä¹°è¿‡&quot;å¸å¦†æ°´&quot;ï¼Œä½†Deepæ¨¡å‹å¯ä»¥æ ¹æ®å¥¹è´­ä¹°&quot;ç²‰åº•æ¶²&quot;å’Œ&quot;çœ¼å½±&quot;çš„è¡Œä¸ºï¼Œæ³›åŒ–å‡ºå¥¹å¯¹&quot;å¸å¦†æ°´&quot;çš„æ½œåœ¨å…´è¶£ã€‚è¿™éƒ¨åˆ†é€šå¸¸ä½¿ç”¨ç”¨æˆ·çš„ç”»åƒç‰¹å¾å’Œç‰©å“çš„å±æ€§ç‰¹å¾ã€‚</li>\n</ul>\n<p><strong>æœ€ç»ˆé¢„æµ‹æ˜¯ä¸¤éƒ¨åˆ†çš„åŠ æƒå’Œ</strong>ï¼Œå†é€šè¿‡Sigmoidå‡½æ•°è¾“å‡ºï¼š\n<span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">âˆ£</mi><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">w</mi><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow><mi>T</mi></msubsup><mi mathvariant=\"bold\">x</mi><mo>+</mo><msubsup><mi mathvariant=\"bold\">w</mi><mrow><mi>d</mi><mi>e</mi><mi>e</mi><mi>p</mi></mrow><mi>T</mi></msubsup><msup><mi mathvariant=\"bold\">a</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>l</mi><mi>f</mi></msub><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[ P(Y=1|\\mathbf{x}) = \\sigma(\\mathbf{w}_{wide}^T \\mathbf{x} + \\mathbf{w}_{deep}^T \\mathbf{a}^{(l_f)} + b) ]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1âˆ£</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1244em;vertical-align:-0.2831em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4169em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3072em;vertical-align:-0.4192em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4169em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">ee</span><span class=\"mord mathnormal mtight\">p</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4192em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2901em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)]</span></span></span></span></p>\n<details class=\"hint-container details\"><summary>Wide &amp; Deep æ ¸å¿ƒé€»è¾‘å®ç°</summary>\n<div class=\"language-python line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"python\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-python\"><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">from</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ...</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">basic</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">layers </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"--shiki-light:#2E8F82;--shiki-dark:#5DA994\"> WideDeep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nn</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Module</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Wide &#x26; Deep Learning model.</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">    Args:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        wide_features (list): the list of `Feature Class`, training by the wide part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        deep_features (list): the list of `Feature Class`, training by the deep part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        mlp_params (dict): the params of the last MLP module, keys include:`{\"dims\":list, \"activation\":str, \"dropout\":float, \"output_layer\":bool`}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> wide_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">        super</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">WideDeep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">).</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">__init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> wide_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> wide_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_features </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> **</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> forward</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_wide </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">wide_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, wide_dims]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, deep_dims]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_wide </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_wide</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, 1]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_deep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, 1]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_wide </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_deep</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sigmoid</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">y</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">squeeze</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></details>\n<h3 id=\"_2-deepfm-ç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-deepfm-ç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰\"><span>2. DeepFMï¼šç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰</span></a></h3>\n<p>Wide &amp; Deepè™½ç„¶å¼ºå¤§ï¼Œä½†å®ƒçš„Wideéƒ¨åˆ†ä»ç„¶ä¾èµ–äººå·¥è®¾è®¡ç‰¹å¾ï¼Œæœªèƒ½å®Œå…¨å®ç°ç«¯åˆ°ç«¯ã€‚<strong>DeepFM (Deep Factorization Machine)</strong> çš„å‡ºç°ï¼Œä¼˜é›…åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>DeepFMçš„æ ¸å¿ƒåˆ›æ–°åœ¨äºï¼š<strong>å®ƒå°†Wideéƒ¨åˆ†æ›¿æ¢ä¸ºäº†ä¸€ä¸ªå› å­åˆ†è§£æœºï¼ˆFMï¼‰</strong>ï¼Œå¹¶ä¸”è¿™ä¸ªFMç»„ä»¶ä¸Deepç»„ä»¶<strong>å…±äº«åŒä¸€å¥—è¾“å…¥åµŒå…¥</strong>ã€‚</p>\n<ul>\n<li><strong>FMç»„ä»¶</strong>ï¼šè´Ÿè´£å­¦ä¹ <strong>ä¸€é˜¶å’ŒäºŒé˜¶ç‰¹å¾äº¤å‰</strong>ã€‚å®ƒèƒ½åƒ<code v-pre>Wide</code>éƒ¨åˆ†ä¸€æ ·æ•æ‰ç‰¹å¾çš„ç›´æ¥å…³è”ï¼Œä½†æ— éœ€äººå·¥è®¾è®¡ã€‚ä¾‹å¦‚ï¼Œ<code v-pre>user_id</code>çš„åµŒå…¥å’Œ<code v-pre>item_id</code>çš„åµŒå…¥å‘é‡åšå†…ç§¯ï¼Œå°±è‡ªåŠ¨åœ°å­¦ä¹ äº†è¿™å¯¹IDçš„äºŒé˜¶äº¤å‰ç‰¹å¾ã€‚</li>\n<li><strong>Deepç»„ä»¶</strong>ï¼šä¸Wide &amp; Deepä¸­çš„Deepéƒ¨åˆ†å®Œå…¨ä¸€æ ·ï¼Œè´Ÿè´£å­¦ä¹ <strong>é«˜é˜¶çš„ã€éšå«çš„ç‰¹å¾äº¤å‰</strong>ã€‚</li>\n</ul>\n<p>è¿™ç§å…±äº«åµŒå…¥çš„æ¶æ„å¸¦æ¥äº†ä¸¤å¤§å¥½å¤„ï¼š</p>\n<ol>\n<li><strong>ç«¯åˆ°ç«¯è®­ç»ƒ</strong>ï¼šä¸å†éœ€è¦ä»»ä½•äººå·¥ç‰¹å¾å·¥ç¨‹ã€‚</li>\n<li><strong>æ•ˆç‡ä¸æ•ˆæœ</strong>ï¼šæ¨¡å‹ä»åŸå§‹ç‰¹å¾ä¸­åŒæ—¶å­¦ä¹ äº†ä¸€é˜¶ã€äºŒé˜¶å’Œé«˜é˜¶çš„äº¤å‰ï¼Œæ•ˆæœæ›´å¥½ï¼Œä¸”å‚æ•°å…±äº«ä½¿å¾—è®­ç»ƒæ›´é«˜æ•ˆã€‚</li>\n</ol>\n<details class=\"hint-container details\"><summary>DeepFM æ ¸å¿ƒé€»è¾‘å®ç°</summary>\n<div class=\"language-python line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"python\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-python\"><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">from</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ...</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">basic</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">layers </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> FM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"--shiki-light:#2E8F82;--shiki-dark:#5DA994\"> DeepFM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nn</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Module</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Deep Factorization Machine Model</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">    Args:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        deep_features (list): the list of `Feature Class`, training by the deep part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        fm_features (list): the list of `Feature Class`, training by the fm part module.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">        mlp_params (dict): the params of the last MLP module, keys include:`{\"dims\":list, \"activation\":str, \"dropout\":float, \"output_layer\":bool`}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">        super</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">DeepFM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">).</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">__init__</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_features </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_dims </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fea</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embed_dim </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fea </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> LR</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 1-odrder interaction</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> FM</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">reduce_sum</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 2-odrder interaction</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> EmbeddingLayer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> MLP</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_dims</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> **</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp_params</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> forward</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">deep_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, deep_dims]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        input_fm </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">embedding</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm_features</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> squeeze_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">False</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, num_fields, embed_dim]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_linear </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">linear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_fm</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">flatten</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">start_dim</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_fm </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">fm</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_fm</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y_deep </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mlp</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">input_deep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  #[batch_size, 1]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_linear </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_fm </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> y_deep</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sigmoid</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">y</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">squeeze</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></details>\n<h3 id=\"_3-din-æ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-din-æ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£\"><span>3. DINï¼šæ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£</span></a></h3>\n<p>æ— è®ºæ˜¯Wide&amp;Deepè¿˜æ˜¯DeepFMï¼Œå®ƒä»¬åœ¨å¤„ç†ç”¨æˆ·å†å²è¡Œä¸ºæ—¶ï¼Œé€šå¸¸åªæ˜¯å°†è¡Œä¸ºåºåˆ—çš„åµŒå…¥å‘é‡è¿›è¡Œç®€å•çš„æ± åŒ–ï¼ˆå¦‚æ±‚å’Œæˆ–å¹³å‡ï¼‰ï¼Œè¿™ç­‰äºæŠŠç”¨æˆ·ä¸°å¯Œå¤šå½©çš„å…´è¶£ï¼ˆå¦‚&quot;çˆ±çœ‹ç¯®çƒ&quot;ã€&quot;åˆšä¹°äº†ç›¸æœº&quot;ã€&quot;æœ€è¿‘åœ¨å¬å¤å…¸ä¹&quot;ï¼‰å‹ç¼©æˆäº†ä¸€ä¸ªæ¨¡ç³Šçš„å¹³å‡å…´è¶£ã€‚</p>\n<p><strong>DIN (Deep Interest Network)</strong> é©å‘½æ€§åœ°æŒ‡å‡ºï¼š<strong>ç”¨æˆ·çš„å…´è¶£æ˜¯åŠ¨æ€çš„ï¼Œåº”è¯¥æ ¹æ®å½“å‰çš„&quot;ç›®æ ‡&quot;æ¥å†³å®šå…³æ³¨å†å²ä¸­çš„å“ªéƒ¨åˆ†ä¿¡æ¯ã€‚</strong> å½“å‘ä¸€ä¸ªç”¨æˆ·æ¨è&quot;ç¯®çƒé‹&quot;æ—¶ï¼Œä»–æœ€è¿‘æµè§ˆ&quot;ç¯®çƒæ¯”èµ›&quot;çš„è¡Œä¸ºå°±åº”è¯¥æ¯”ä»–ä¸Šå‘¨è´­ä¹°&quot;ç›¸æœº&quot;çš„è¡Œä¸ºè·å¾—æ›´é«˜çš„æƒé‡ã€‚</p>\n<p>DINä¸ºæ­¤è®¾è®¡äº†<strong>æ³¨æ„åŠ›æœºåˆ¶ï¼ˆAttention Mechanismï¼‰</strong>ï¼š</p>\n<ul>\n<li>å®ƒå°†<strong>å€™é€‰ç‰©å“ï¼ˆTarget Itemï¼‰</strong> ä½œä¸º&quot;æŸ¥è¯¢ï¼ˆQueryï¼‰&quot;ã€‚</li>\n<li>å°†ç”¨æˆ·çš„<strong>å†å²è¡Œä¸ºåºåˆ—ï¼ˆHistory Behaviorsï¼‰</strong> ä½œä¸º&quot;é”®ï¼ˆKeysï¼‰&quot;å’Œ&quot;å€¼ï¼ˆValuesï¼‰&quot;ã€‚</li>\n<li>é€šè¿‡ä¸€ä¸ª&quot;æ³¨æ„åŠ›æ¿€æ´»å•å…ƒ&quot;ï¼ˆæœ¬è´¨æ˜¯ä¸ªå°å‹MLPï¼‰ï¼Œè®¡ç®—å€™é€‰ç‰©å“ä¸æ¯ä¸€æ¡å†å²è¡Œä¸ºçš„&quot;ç›¸å…³æ€§å¾—åˆ†&quot;ã€‚</li>\n<li>æœ€åï¼Œç”¨è¿™äº›å¾—åˆ†ä½œä¸ºæƒé‡ï¼Œå¯¹å†å²è¡Œä¸ºåºåˆ—çš„åµŒå…¥è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°ä¸€ä¸ªä¸ºå½“å‰å€™é€‰ç‰©å“&quot;é‡èº«å®šåˆ¶&quot;çš„ç”¨æˆ·å…´è¶£è¡¨ç¤ºã€‚</li>\n</ul>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>UserInterest</mtext><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">c</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msub><mi>Î±</mi><mi>i</mi></msub><mo>â‹…</mo><msub><mi mathvariant=\"bold\">h</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mtext>attention</mtext><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">c</mi><mo separator=\"true\">,</mo><msub><mi mathvariant=\"bold\">h</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>â‹…</mo><msub><mi mathvariant=\"bold\">h</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\text{UserInterest}(\\mathbf{c}) = \\sum_{i=1}^{T} \\alpha_i \\cdot \\mathbf{h}_i = \\sum_{i=1}^{T} \\text{attention}(\\mathbf{c}, \\mathbf{h}_i) \\cdot \\mathbf{h}_i \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">UserInterest</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">attention</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">c</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>DINæ ‡å¿—ç€æ¨èæ¨¡å‹ä»å¯¹&quot;é™æ€ç”¨æˆ·ç”»åƒ&quot;çš„ç†è§£ï¼Œè¿ˆå‘äº†å¯¹&quot;åŠ¨æ€ç”¨æˆ·æ„å›¾&quot;çš„æ•æ‰ã€‚</p>\n<h2 id=\"ğŸ™ï¸-åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§-å¤šä»»åŠ¡å­¦ä¹ \" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸ™ï¸-åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§-å¤šä»»åŠ¡å­¦ä¹ \"><span>ğŸ™ï¸ åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§ï¼šå¤šä»»åŠ¡å­¦ä¹ </span></a></h2>\n<p>åœ¨çœŸå®çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¸åªå…³å¿ƒ<strong>ç‚¹å‡»ç‡ï¼ˆCTRï¼‰</strong>ï¼Œè¿˜å…³å¿ƒ<strong>è½¬åŒ–ç‡ï¼ˆCVRï¼‰</strong>ã€<strong>è§‚çœ‹æ—¶é•¿</strong>ã€<strong>åˆ†äº«ç‡</strong>ç­‰å¤šä¸ªæŒ‡æ ‡ã€‚å¤šä»»åŠ¡å­¦ä¹ ï¼ˆMulti-Task Learning, MTLï¼‰å°±æ˜¯ä¸ºäº†åŒæ—¶ä¼˜åŒ–è¿™äº›ç›®æ ‡è€Œè®¾è®¡çš„ã€‚</p>\n<p>æœ€ç»å…¸çš„æ¨¡å‹ä¹‹ä¸€æ˜¯ <strong>ESMM (Entire Space Multi-task Model)</strong>ï¼Œå®ƒå·§å¦™åœ°åˆ©ç”¨äº†ä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»ã€‚åœ¨ç”µå•†åœºæ™¯ä¸­ï¼Œç”¨æˆ·å¿…é¡»å…ˆ&quot;ç‚¹å‡»&quot;å•†å“ï¼Œæ‰å¯èƒ½&quot;è´­ä¹°&quot;å•†å“ã€‚å› æ­¤ï¼Œè½¬åŒ–ï¼ˆPurchaseï¼‰è¡Œä¸ºå¿…ç„¶å‘ç”Ÿåœ¨ç‚¹å‡»ï¼ˆClickï¼‰è¡Œä¸ºä¹‹åã€‚ESMMåˆ©ç”¨è¿™ä¸ªå…³ç³»ï¼Œå°†é¢„æµ‹ç›®æ ‡åˆ†è§£ä¸ºï¼š</p>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>conversion</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>impression</mtext><mo stretchy=\"false\">)</mo><mo>=</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>click</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>impression</mtext><mo stretchy=\"false\">)</mo><mo>Ã—</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>conversion</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>click</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\text{conversion} | \\text{impression}) = p(\\text{click} | \\text{impression}) \\times p(\\text{conversion} | \\text{click}) \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">conversion</span></span><span class=\"mord\">âˆ£</span><span class=\"mord text\"><span class=\"mord\">impression</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">click</span></span><span class=\"mord\">âˆ£</span><span class=\"mord text\"><span class=\"mord\">impression</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">conversion</span></span><span class=\"mord\">âˆ£</span><span class=\"mord text\"><span class=\"mord\">click</span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mi>C</mi><mi>T</mi><mi>C</mi><mi>V</mi><mi>R</mi><mo>=</mo><mi>p</mi><mi>C</mi><mi>T</mi><mi>R</mi><mo>Ã—</mo><mi>p</mi><mi>C</mi><mi>V</mi><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">pCTCVR = pCTR \\times pCVR \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">pCTC</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">pCTR</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">pC</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span></p>\n<p>æ¨¡å‹é€šè¿‡æ„å»ºä¸¤ä¸ªç‹¬ç«‹çš„é¢„æµ‹å¡”ï¼ˆä¸€ä¸ªé¢„æµ‹pCTRï¼Œä¸€ä¸ªé¢„æµ‹pCVRï¼‰ï¼Œå¹¶å…±äº«åº•å±‚çš„ç‰¹å¾åµŒå…¥ã€‚å…³é”®åœ¨äºï¼ŒpCVRå¡”çš„è®­ç»ƒä¿¡å·æ¥è‡ªäºpCTCVRçš„é¢„æµ‹ç»“æœï¼Œä»è€Œå·§å¦™åœ°è§£å†³äº†ç›´æ¥å¯¹CVRå»ºæ¨¡æ—¶å­˜åœ¨çš„<strong>æ ·æœ¬é€‰æ‹©åå·®</strong>ï¼ˆåªæœ‰ç‚¹å‡»æ ·æœ¬æ‰æœ‰è½¬åŒ–æ ‡ç­¾ï¼‰å’Œ<strong>æ•°æ®ç¨€ç–</strong>é—®é¢˜ã€‚</p>\n<h2 id=\"ğŸ“–-å»¶ä¼¸é˜…è¯»\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#ğŸ“–-å»¶ä¼¸é˜…è¯»\"><span>ğŸ“– å»¶ä¼¸é˜…è¯»</span></a></h2>\n<ol>\n<li><a href=\"https://arxiv.org/abs/1606.07792\" target=\"_blank\" rel=\"noopener noreferrer\">Wide &amp; Deep Learning for Recommender Systems (DLRS'16)</a> - æ·±åº¦å­¦ä¹ æ¨èçš„å¼€å±±ä¹‹ä½œã€‚</li>\n<li><a href=\"https://arxiv.org/abs/1703.04247\" target=\"_blank\" rel=\"noopener noreferrer\">DeepFM: A Factorization-Machine based Neural Network for CTR Prediction (IJCAI'17)</a> - ä¼˜é›…åœ°ç»Ÿä¸€äº†ä½é˜¶å’Œé«˜é˜¶ç‰¹å¾äº¤å‰ã€‚</li>\n<li><a href=\"https://arxiv.org/abs/1706.06978\" target=\"_blank\" rel=\"noopener noreferrer\">Deep Interest Network for Click-Through Rate Prediction (KDD'18)</a> - å°†æ³¨æ„åŠ›æœºåˆ¶æˆåŠŸå¼•å…¥æ¨èé¢†åŸŸã€‚</li>\n<li><a href=\"https://arxiv.org/abs/1804.07931\" target=\"_blank\" rel=\"noopener noreferrer\">Entire Space Multi-Task Model: An Effective Approach for Estimating Post-Click Conversion Rate (SIGIR'18)</a> - å¤šä»»åŠ¡å­¦ä¹ çš„ç»å…¸èŒƒå¼ã€‚</li>\n</ol>\n<blockquote>\n<p>ğŸ§  <strong>æ€è€ƒé¢˜</strong></p>\n<ol>\n<li><strong>ç‰¹å¾é€‰æ‹©</strong>ï¼šåœ¨è®¾è®¡Wide &amp; Deepæ¨¡å‹æ—¶ï¼Œä½ ä¼šå¦‚ä½•åˆ’åˆ†ç‰¹å¾è¿›å…¥Wideéƒ¨åˆ†å’ŒDeepéƒ¨åˆ†ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜å¹¶é™ˆè¿°ä½ çš„ç†ç”±ã€‚</li>\n<li><strong>å†·å¯åŠ¨é—®é¢˜</strong>ï¼šå¯¹äºä¸€ä¸ªæ²¡æœ‰ä»»ä½•å†å²è¡Œä¸ºçš„æ–°ç”¨æˆ·ï¼Œä½ è®¤ä¸ºDeepFMå’ŒDINå“ªä¸ªæ¨¡å‹èƒ½æ›´å¥½åœ°å¤„ç†ä»–çš„æ¨èè¯·æ±‚ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>\n<li><strong>æ³¨æ„åŠ›å¤±æ•ˆ</strong>ï¼šåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä½ è®¤ä¸ºDINçš„æ³¨æ„åŠ›æœºåˆ¶å¯èƒ½ä¼š&quot;å¤±æ•ˆ&quot;æˆ–è€…è¯´ä¸èµ·ä½œç”¨ï¼Ÿï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·çš„è¡Œä¸ºåºåˆ—éå¸¸çŸ­ï¼Œæˆ–è€…è¡Œä¸ºéå¸¸å•ä¸€ï¼‰</li>\n<li><strong>å¤šä»»åŠ¡çš„æŒ‘æˆ˜</strong>ï¼šé™¤äº†ESMMï¼Œä½ è¿˜èƒ½æƒ³åˆ°å“ªäº›æ–¹æ³•æ¥è§£å†³å¤šä»»åŠ¡å­¦ä¹ ä¸­å¯èƒ½å‡ºç°çš„&quot;è··è··æ¿æ•ˆåº”&quot;ï¼ˆå³ä¸€ä¸ªä»»åŠ¡æ€§èƒ½æå‡ï¼Œå¦ä¸€ä¸ªä»»åŠ¡æ€§èƒ½ä¸‹é™ï¼‰ï¼Ÿï¼ˆæç¤ºï¼šå¯ä»¥æ€è€ƒMMoEç­‰æ¨¡å‹ï¼‰</li>\n<li><strong>è¶…è¶ŠID</strong>ï¼šæœ¬ç« è®¨è®ºçš„æ¨¡å‹ä¸»è¦åŸºäºç”¨æˆ·çš„è¡Œä¸ºIDåºåˆ—ã€‚å¦‚æœä½ çš„ç‰©å“æœ‰ä¸°å¯Œçš„æ–‡æœ¬æˆ–å›¾åƒå†…å®¹ï¼Œä½ ä¼šå¦‚ä½•æ”¹é€ è¿™äº›æ¨¡å‹æ¥åˆ©ç”¨è¿™äº›å¤šæ¨¡æ€ä¿¡æ¯ï¼Ÿ</li>\n</ol>\n</blockquote>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">ğŸ‰ ç« èŠ‚å°ç»“</p>\n<p>æ·±åº¦å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„&quot;æ–‡è‰ºå¤å…´&quot;ï¼Œæœ¬è´¨ä¸Šæ˜¯ä»æ‰‹å·¥ç‰¹å¾å·¥ç¨‹å‘è‡ªåŠ¨è¡¨ç¤ºå­¦ä¹ çš„èŒƒå¼è½¬å˜ã€‚Wide &amp; Deepå¼€å¯äº†è®°å¿†ä¸æ³›åŒ–å¹¶é‡çš„æ—¶ä»£ï¼ŒDeepFMå®ç°äº†çœŸæ­£çš„ç«¯åˆ°ç«¯å­¦ä¹ ï¼ŒDINåˆ™è®©æˆ‘ä»¬ç†è§£äº†ç”¨æˆ·å…´è¶£çš„åŠ¨æ€æ€§ã€‚è¿™åœºé©å‘½ä¸ä»…è§£æ”¾äº†ç®—æ³•å·¥ç¨‹å¸ˆçš„åŒæ‰‹ï¼Œæ›´é‡è¦çš„æ˜¯è®©æ¨èç³»ç»Ÿå…·å¤‡äº†ç†è§£å¤æ‚ç”¨æˆ·è¡Œä¸ºæ¨¡å¼çš„èƒ½åŠ›ã€‚ä»é™æ€ç”»åƒåˆ°åŠ¨æ€æ„å›¾ï¼Œä»å•ä¸€ç›®æ ‡åˆ°å¤šä»»åŠ¡ä¼˜åŒ–ï¼Œæ·±åº¦å­¦ä¹ ä¸ºæ¨èç³»ç»Ÿæ³¨å…¥äº†å‰æ‰€æœªæœ‰çš„æ™ºèƒ½ã€‚</p>\n</div>\n<hr>\n<blockquote>\n<p>&quot;The best way to predict the future is to invent it.&quot; â€”â€” Alan Kay<br>\næ·±åº¦å­¦ä¹ ä¸ä»…é¢„æµ‹äº†æ¨èç³»ç»Ÿçš„æœªæ¥ï¼Œæ›´æ˜¯äº²æ‰‹åˆ›é€ äº†è¿™ä¸ªæ™ºèƒ½åŒ–çš„æœªæ¥ã€‚</p>\n</blockquote>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"åœ¨æ·±åº¦å­¦ä¹ æµªæ½®å¸­å·äººå·¥æ™ºèƒ½çš„å„ä¸ªé¢†åŸŸä¹‹å‰ï¼Œæ¨èç³»ç»Ÿç”±ååŒè¿‡æ»¤ã€é€»è¾‘å›å½’ï¼ˆLRï¼‰å’Œå› å­åˆ†è§£æœºï¼ˆFMï¼‰ç­‰æ¨¡å‹ä¸»å¯¼ã€‚è¿™äº›æ¨¡å‹ç®€æ´ã€æœ‰æ•ˆï¼Œä½†å®ƒä»¬å…±åŒçš„\"é˜¿å–€ç‰æ–¯ä¹‹è¸µ\"æ˜¯â€”â€”**ç‰¹å¾å·¥ç¨‹ï¼ˆFeature Engineeringï¼‰**ã€‚ç®—æ³•å·¥ç¨‹å¸ˆä»¬å¦‚åŒæ‰‹å·¥è‰ºäººï¼Œéœ€è¦å‡­å€Ÿå¤§é‡çš„é¢†åŸŸçŸ¥è¯†ã€ç»éªŒå’Œç›´è§‰ï¼Œæ‰‹åŠ¨è®¾è®¡æœ‰æ•ˆçš„äº¤å‰ç‰¹å¾ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè€Œä¸”å¾€å¾€éš¾ä»¥å‘æ˜å‡ºæ•°æ®ä¸­é‚£äº›\"åç›´è§‰\"çš„éšè—æ¨¡å¼ã€‚\n\n2016å¹´ï¼ŒGoogleä¸€ç¯‡ã€ŠWide & Deep Learning for Recommender Systemsã€‹æ¨ªç©ºå‡ºä¸–ï¼Œå¦‚åŒä¸€å£°å·è§’ï¼Œæ­£å¼å®£å‘Šäº†æ¨èç³»ç»Ÿ\"æ–‡è‰ºå¤å…´\"æ—¶ä»£çš„åˆ°æ¥ã€‚è¿™åœºå¤å…´çš„æ ¸å¿ƒï¼Œæ­£æ˜¯**ç”¨æ·±åº¦å­¦ä¹ å®ç°\"ç«¯åˆ°ç«¯\"çš„è‡ªåŠ¨åŒ–ç‰¹å¾å­¦ä¹ **ï¼Œå°†å·¥ç¨‹å¸ˆä»ç¹é‡çš„ä½“åŠ›åŠ³åŠ¨ä¸­è§£æ”¾å‡ºæ¥ï¼Œå»æ¢ç´¢æ›´å¹¿é˜”çš„æ¨¡å‹ç»“æ„å’Œä¸šåŠ¡è¾¹ç•Œã€‚\n\n## ğŸš€ èŒƒå¼é©å‘½ï¼šä»\"ç‰¹å¾å·¥ç¨‹\"åˆ°\"è¡¨ç¤ºå­¦ä¹ \"\n\næ·±åº¦å­¦ä¹ å¸¦æ¥çš„é©å‘½ï¼Œå…¶æœ¬è´¨æ˜¯ **è¡¨ç¤ºå­¦ä¹ ï¼ˆRepresentation Learningï¼‰** ä»£æ›¿äº†æ‰‹å·¥ç‰¹å¾å·¥ç¨‹ã€‚\n\n-   **æ—§èŒƒå¼**ï¼š`åŸå§‹æ•°æ® -> äººå·¥ç‰¹å¾å·¥ç¨‹ -> ç®€å•æ¨¡å‹ï¼ˆå¦‚LRï¼‰ -> é¢„æµ‹`\n-   **æ–°èŒƒå¼**ï¼š`åŸå§‹æ•°æ® -> è‡ªåŠ¨è¡¨ç¤ºå­¦ä¹ ï¼ˆEmbeddingï¼‰ -> å¤æ‚æ¨¡å‹ï¼ˆå¦‚DNNï¼‰ -> é¢„æµ‹`\n\n**åµŒå…¥ï¼ˆEmbeddingï¼‰** æ˜¯è¿™åœºé©å‘½çš„åŸºçŸ³ã€‚å®ƒå°†æ¯ä¸€ä¸ªåŸå§‹ã€é«˜ç»´ã€ç¨€ç–çš„ç‰¹å¾ï¼ˆå¦‚æ¯ä¸€ä¸ª`user_id`æˆ–`item_id`ï¼‰ï¼Œæ˜ å°„åˆ°ä¸€ä¸ªä½ç»´ã€ç¨ å¯†çš„å‘é‡ç©ºé—´ä¸­ã€‚åœ¨è¿™ä¸ªç¥å¥‡çš„ç©ºé—´é‡Œï¼Œç›¸ä¼¼çš„ç‰©å“æˆ–ç”¨æˆ·åœ¨è·ç¦»ä¸Šä¼šæ›´æ¥è¿‘ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™äº›åµŒå…¥å‘é‡æˆä¸ºäº†ç¥ç»ç½‘ç»œçš„\"é€šç”¨è¯­è¨€\"ï¼Œä½¿å¾—ç«¯åˆ°ç«¯çš„å­¦ä¹ æˆä¸ºå¯èƒ½ã€‚\n\n```mermaid\ngraph TD\n    subgraph \"æ—§èŒƒå¼ï¼šç‰¹å¾å·¥ç¨‹\"\n        direction LR\n        A[åŸå§‹ID] --> B{\"ç‰¹å¾å·¥ç¨‹<br/>(eg: age_gender, item_cate)\"} --> C[LR/FM]\n    end\n\n    subgraph \"æ–°èŒƒå¼ï¼šè¡¨ç¤ºå­¦ä¹ \"\n        direction LR\n        D[åŸå§‹ID] --> E{\"Embeddingå±‚<br/>(è‡ªåŠ¨å­¦ä¹ )\"} --> F[ç¨ å¯†å‘é‡] --> G[DNN]\n    end\n    \n    C --> P[é¢„æµ‹]\n    G --> P\n```\n\n## ğŸ¯ æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯\n\næ·±åº¦å­¦ä¹ æ¨èæ¨¡å‹çš„æ¼”è¿›ï¼Œæ¸…æ™°åœ°åæ˜ äº†ä¸šç•Œå¯¹\"è®°å¿†\"ä¸\"æ³›åŒ–\"èƒ½åŠ›ã€ä»¥åŠå¯¹ç”¨æˆ·å…´è¶£ç†è§£æ·±åº¦çš„ä¸æ–­è¿½æ±‚ã€‚\n\n### 1. Wide & Deepï¼šè®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹\n\nWide & Deepæ¨¡å‹çš„è®¾è®¡å“²å­¦å……æ»¡äº†æ™ºæ…§çš„å¹³è¡¡ã€‚å®ƒæ²¡æœ‰å®Œå…¨æŠ›å¼ƒä¼ ç»Ÿæ–¹æ³•çš„ä¼˜ç‚¹ï¼Œè€Œæ˜¯å°†ä¸¤è€…å·§å¦™åœ°ç»“åˆèµ·æ¥ï¼Œæ˜¯\"æ‰¿å‰å¯å\"çš„ç»å…¸ä¹‹ä½œã€‚\n\n-   **Wideéƒ¨åˆ†ï¼ˆè®°å¿†ï¼‰**ï¼šæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¹¿ä¹‰çº¿æ€§æ¨¡å‹ã€‚å®ƒè´Ÿè´£\"è®°å¿†\"é‚£äº›åœ¨å†å²æ•°æ®ä¸­è¢«åå¤éªŒè¯è¿‡çš„ã€é‡è¦çš„ã€æ˜¾å¼çš„äº¤å‰ç‰¹å¾ã€‚ä¾‹å¦‚ï¼Œ`AND(user_gender=female, item_category=cosmetics)` è¿™ç§å¼ºå…±ç°è§„åˆ™ï¼Œå¯ä»¥è¢«Wideéƒ¨åˆ†å¿«é€Ÿã€ç²¾å‡†åœ°è®°ä½ã€‚è¿™éƒ¨åˆ†é€šå¸¸ä½¿ç”¨éœ€è¦äººå·¥è®¾è®¡çš„ç¨€ç–äº¤å‰ç‰¹å¾ã€‚\n-   **Deepéƒ¨åˆ†ï¼ˆæ³›åŒ–ï¼‰**ï¼šæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆDNNï¼‰ã€‚å®ƒè´Ÿè´£\"æ³›åŒ–\"ï¼Œé€šè¿‡ç‰¹å¾çš„å¤šæ¬¡éçº¿æ€§å˜æ¢ï¼Œæ¢ç´¢é‚£äº›ä»æœªæˆ–å¾ˆå°‘åœ¨å†å²ä¸­å‡ºç°è¿‡çš„ã€æ½œåœ¨çš„ç‰¹å¾ç»„åˆã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨æˆ·ä»æœªä¹°è¿‡\"å¸å¦†æ°´\"ï¼Œä½†Deepæ¨¡å‹å¯ä»¥æ ¹æ®å¥¹è´­ä¹°\"ç²‰åº•æ¶²\"å’Œ\"çœ¼å½±\"çš„è¡Œä¸ºï¼Œæ³›åŒ–å‡ºå¥¹å¯¹\"å¸å¦†æ°´\"çš„æ½œåœ¨å…´è¶£ã€‚è¿™éƒ¨åˆ†é€šå¸¸ä½¿ç”¨ç”¨æˆ·çš„ç”»åƒç‰¹å¾å’Œç‰©å“çš„å±æ€§ç‰¹å¾ã€‚\n\n**æœ€ç»ˆé¢„æµ‹æ˜¯ä¸¤éƒ¨åˆ†çš„åŠ æƒå’Œ**ï¼Œå†é€šè¿‡Sigmoidå‡½æ•°è¾“å‡ºï¼š\n$[ P(Y=1|\\mathbf{x}) = \\sigma(\\mathbf{w}_{wide}^T \\mathbf{x} + \\mathbf{w}_{deep}^T \\mathbf{a}^{(l_f)} + b) ]$\n\n::: details Wide & Deep æ ¸å¿ƒé€»è¾‘å®ç°\n```python\nimport torch\n\nfrom ...basic.layers import LR, MLP, EmbeddingLayer\n\n\nclass WideDeep(torch.nn.Module):\n    \"\"\"Wide & Deep Learning model.\n\n    Args:\n        wide_features (list): the list of `Feature Class`, training by the wide part module.\n        deep_features (list): the list of `Feature Class`, training by the deep part module.\n        mlp_params (dict): the params of the last MLP module, keys include:`{\"dims\":list, \"activation\":str, \"dropout\":float, \"output_layer\":bool`}\n    \"\"\"\n\n    def __init__(self, wide_features, deep_features, mlp_params):\n        super(WideDeep, self).__init__()\n        self.wide_features = wide_features\n        self.deep_features = deep_features\n        self.wide_dims = sum([fea.embed_dim for fea in wide_features])\n        self.deep_dims = sum([fea.embed_dim for fea in deep_features])\n        self.linear = LR(self.wide_dims)\n        self.embedding = EmbeddingLayer(wide_features + deep_features)\n        self.mlp = MLP(self.deep_dims, **mlp_params)\n\n    def forward(self, x):\n        input_wide = self.embedding(x, self.wide_features, squeeze_dim=True)  #[batch_size, wide_dims]\n        input_deep = self.embedding(x, self.deep_features, squeeze_dim=True)  #[batch_size, deep_dims]\n\n        y_wide = self.linear(input_wide)  #[batch_size, 1]\n        y_deep = self.mlp(input_deep)  #[batch_size, 1]\n        y = y_wide + y_deep\n        y = torch.sigmoid(y.squeeze(1))\n        return y\n```\n:::\n\n### 2. DeepFMï¼šç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰\n\nWide & Deepè™½ç„¶å¼ºå¤§ï¼Œä½†å®ƒçš„Wideéƒ¨åˆ†ä»ç„¶ä¾èµ–äººå·¥è®¾è®¡ç‰¹å¾ï¼Œæœªèƒ½å®Œå…¨å®ç°ç«¯åˆ°ç«¯ã€‚**DeepFM (Deep Factorization Machine)** çš„å‡ºç°ï¼Œä¼˜é›…åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚\n\nDeepFMçš„æ ¸å¿ƒåˆ›æ–°åœ¨äºï¼š**å®ƒå°†Wideéƒ¨åˆ†æ›¿æ¢ä¸ºäº†ä¸€ä¸ªå› å­åˆ†è§£æœºï¼ˆFMï¼‰**ï¼Œå¹¶ä¸”è¿™ä¸ªFMç»„ä»¶ä¸Deepç»„ä»¶**å…±äº«åŒä¸€å¥—è¾“å…¥åµŒå…¥**ã€‚\n\n-   **FMç»„ä»¶**ï¼šè´Ÿè´£å­¦ä¹ **ä¸€é˜¶å’ŒäºŒé˜¶ç‰¹å¾äº¤å‰**ã€‚å®ƒèƒ½åƒ`Wide`éƒ¨åˆ†ä¸€æ ·æ•æ‰ç‰¹å¾çš„ç›´æ¥å…³è”ï¼Œä½†æ— éœ€äººå·¥è®¾è®¡ã€‚ä¾‹å¦‚ï¼Œ`user_id`çš„åµŒå…¥å’Œ`item_id`çš„åµŒå…¥å‘é‡åšå†…ç§¯ï¼Œå°±è‡ªåŠ¨åœ°å­¦ä¹ äº†è¿™å¯¹IDçš„äºŒé˜¶äº¤å‰ç‰¹å¾ã€‚\n-   **Deepç»„ä»¶**ï¼šä¸Wide & Deepä¸­çš„Deepéƒ¨åˆ†å®Œå…¨ä¸€æ ·ï¼Œè´Ÿè´£å­¦ä¹ **é«˜é˜¶çš„ã€éšå«çš„ç‰¹å¾äº¤å‰**ã€‚\n\nè¿™ç§å…±äº«åµŒå…¥çš„æ¶æ„å¸¦æ¥äº†ä¸¤å¤§å¥½å¤„ï¼š\n1.  **ç«¯åˆ°ç«¯è®­ç»ƒ**ï¼šä¸å†éœ€è¦ä»»ä½•äººå·¥ç‰¹å¾å·¥ç¨‹ã€‚\n2.  **æ•ˆç‡ä¸æ•ˆæœ**ï¼šæ¨¡å‹ä»åŸå§‹ç‰¹å¾ä¸­åŒæ—¶å­¦ä¹ äº†ä¸€é˜¶ã€äºŒé˜¶å’Œé«˜é˜¶çš„äº¤å‰ï¼Œæ•ˆæœæ›´å¥½ï¼Œä¸”å‚æ•°å…±äº«ä½¿å¾—è®­ç»ƒæ›´é«˜æ•ˆã€‚\n\n::: details DeepFM æ ¸å¿ƒé€»è¾‘å®ç°\n```python\nimport torch\n\nfrom ...basic.layers import FM, MLP, LR, EmbeddingLayer\n\n\nclass DeepFM(torch.nn.Module):\n    \"\"\"Deep Factorization Machine Model\n\n    Args:\n        deep_features (list): the list of `Feature Class`, training by the deep part module.\n        fm_features (list): the list of `Feature Class`, training by the fm part module.\n        mlp_params (dict): the params of the last MLP module, keys include:`{\"dims\":list, \"activation\":str, \"dropout\":float, \"output_layer\":bool`}\n    \"\"\"\n\n    def __init__(self, deep_features, fm_features, mlp_params):\n        super(DeepFM, self).__init__()\n        self.deep_features = deep_features\n        self.fm_features = fm_features\n        self.deep_dims = sum([fea.embed_dim for fea in deep_features])\n        self.fm_dims = sum([fea.embed_dim for fea in fm_features])\n        self.linear = LR(self.fm_dims)  # 1-odrder interaction\n        self.fm = FM(reduce_sum=True)  # 2-odrder interaction\n        self.embedding = EmbeddingLayer(deep_features + fm_features)\n        self.mlp = MLP(self.deep_dims, **mlp_params)\n\n    def forward(self, x):\n        input_deep = self.embedding(x, self.deep_features, squeeze_dim=True)  #[batch_size, deep_dims]\n        input_fm = self.embedding(x, self.fm_features, squeeze_dim=False)  #[batch_size, num_fields, embed_dim]\n\n        y_linear = self.linear(input_fm.flatten(start_dim=1))\n        y_fm = self.fm(input_fm)\n        y_deep = self.mlp(input_deep)  #[batch_size, 1]\n        y = y_linear + y_fm + y_deep\n        return torch.sigmoid(y.squeeze(1))\n```\n:::\n\n\n### 3. DINï¼šæ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£\n\næ— è®ºæ˜¯Wide&Deepè¿˜æ˜¯DeepFMï¼Œå®ƒä»¬åœ¨å¤„ç†ç”¨æˆ·å†å²è¡Œä¸ºæ—¶ï¼Œé€šå¸¸åªæ˜¯å°†è¡Œä¸ºåºåˆ—çš„åµŒå…¥å‘é‡è¿›è¡Œç®€å•çš„æ± åŒ–ï¼ˆå¦‚æ±‚å’Œæˆ–å¹³å‡ï¼‰ï¼Œè¿™ç­‰äºæŠŠç”¨æˆ·ä¸°å¯Œå¤šå½©çš„å…´è¶£ï¼ˆå¦‚\"çˆ±çœ‹ç¯®çƒ\"ã€\"åˆšä¹°äº†ç›¸æœº\"ã€\"æœ€è¿‘åœ¨å¬å¤å…¸ä¹\"ï¼‰å‹ç¼©æˆäº†ä¸€ä¸ªæ¨¡ç³Šçš„å¹³å‡å…´è¶£ã€‚\n\n**DIN (Deep Interest Network)** é©å‘½æ€§åœ°æŒ‡å‡ºï¼š**ç”¨æˆ·çš„å…´è¶£æ˜¯åŠ¨æ€çš„ï¼Œåº”è¯¥æ ¹æ®å½“å‰çš„\"ç›®æ ‡\"æ¥å†³å®šå…³æ³¨å†å²ä¸­çš„å“ªéƒ¨åˆ†ä¿¡æ¯ã€‚** å½“å‘ä¸€ä¸ªç”¨æˆ·æ¨è\"ç¯®çƒé‹\"æ—¶ï¼Œä»–æœ€è¿‘æµè§ˆ\"ç¯®çƒæ¯”èµ›\"çš„è¡Œä¸ºå°±åº”è¯¥æ¯”ä»–ä¸Šå‘¨è´­ä¹°\"ç›¸æœº\"çš„è¡Œä¸ºè·å¾—æ›´é«˜çš„æƒé‡ã€‚\n\nDINä¸ºæ­¤è®¾è®¡äº†**æ³¨æ„åŠ›æœºåˆ¶ï¼ˆAttention Mechanismï¼‰**ï¼š\n-   å®ƒå°†**å€™é€‰ç‰©å“ï¼ˆTarget Itemï¼‰** ä½œä¸º\"æŸ¥è¯¢ï¼ˆQueryï¼‰\"ã€‚\n-   å°†ç”¨æˆ·çš„**å†å²è¡Œä¸ºåºåˆ—ï¼ˆHistory Behaviorsï¼‰** ä½œä¸º\"é”®ï¼ˆKeysï¼‰\"å’Œ\"å€¼ï¼ˆValuesï¼‰\"ã€‚\n-   é€šè¿‡ä¸€ä¸ª\"æ³¨æ„åŠ›æ¿€æ´»å•å…ƒ\"ï¼ˆæœ¬è´¨æ˜¯ä¸ªå°å‹MLPï¼‰ï¼Œè®¡ç®—å€™é€‰ç‰©å“ä¸æ¯ä¸€æ¡å†å²è¡Œä¸ºçš„\"ç›¸å…³æ€§å¾—åˆ†\"ã€‚\n-   æœ€åï¼Œç”¨è¿™äº›å¾—åˆ†ä½œä¸ºæƒé‡ï¼Œå¯¹å†å²è¡Œä¸ºåºåˆ—çš„åµŒå…¥è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°ä¸€ä¸ªä¸ºå½“å‰å€™é€‰ç‰©å“\"é‡èº«å®šåˆ¶\"çš„ç”¨æˆ·å…´è¶£è¡¨ç¤ºã€‚\n\n$$ \\text{UserInterest}(\\mathbf{c}) = \\sum_{i=1}^{T} \\alpha_i \\cdot \\mathbf{h}_i = \\sum_{i=1}^{T} \\text{attention}(\\mathbf{c}, \\mathbf{h}_i) \\cdot \\mathbf{h}_i $$\n\nDINæ ‡å¿—ç€æ¨èæ¨¡å‹ä»å¯¹\"é™æ€ç”¨æˆ·ç”»åƒ\"çš„ç†è§£ï¼Œè¿ˆå‘äº†å¯¹\"åŠ¨æ€ç”¨æˆ·æ„å›¾\"çš„æ•æ‰ã€‚\n\n## ğŸ™ï¸ åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§ï¼šå¤šä»»åŠ¡å­¦ä¹ \n\nåœ¨çœŸå®çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¸åªå…³å¿ƒ**ç‚¹å‡»ç‡ï¼ˆCTRï¼‰**ï¼Œè¿˜å…³å¿ƒ**è½¬åŒ–ç‡ï¼ˆCVRï¼‰**ã€**è§‚çœ‹æ—¶é•¿**ã€**åˆ†äº«ç‡**ç­‰å¤šä¸ªæŒ‡æ ‡ã€‚å¤šä»»åŠ¡å­¦ä¹ ï¼ˆMulti-Task Learning, MTLï¼‰å°±æ˜¯ä¸ºäº†åŒæ—¶ä¼˜åŒ–è¿™äº›ç›®æ ‡è€Œè®¾è®¡çš„ã€‚\n\næœ€ç»å…¸çš„æ¨¡å‹ä¹‹ä¸€æ˜¯ **ESMM (Entire Space Multi-task Model)**ï¼Œå®ƒå·§å¦™åœ°åˆ©ç”¨äº†ä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»ã€‚åœ¨ç”µå•†åœºæ™¯ä¸­ï¼Œç”¨æˆ·å¿…é¡»å…ˆ\"ç‚¹å‡»\"å•†å“ï¼Œæ‰å¯èƒ½\"è´­ä¹°\"å•†å“ã€‚å› æ­¤ï¼Œè½¬åŒ–ï¼ˆPurchaseï¼‰è¡Œä¸ºå¿…ç„¶å‘ç”Ÿåœ¨ç‚¹å‡»ï¼ˆClickï¼‰è¡Œä¸ºä¹‹åã€‚ESMMåˆ©ç”¨è¿™ä¸ªå…³ç³»ï¼Œå°†é¢„æµ‹ç›®æ ‡åˆ†è§£ä¸ºï¼š\n$$ p(\\text{conversion} | \\text{impression}) = p(\\text{click} | \\text{impression}) \\times p(\\text{conversion} | \\text{click}) $$\n\n$$ pCTCVR = pCTR \\times pCVR $$\n\næ¨¡å‹é€šè¿‡æ„å»ºä¸¤ä¸ªç‹¬ç«‹çš„é¢„æµ‹å¡”ï¼ˆä¸€ä¸ªé¢„æµ‹pCTRï¼Œä¸€ä¸ªé¢„æµ‹pCVRï¼‰ï¼Œå¹¶å…±äº«åº•å±‚çš„ç‰¹å¾åµŒå…¥ã€‚å…³é”®åœ¨äºï¼ŒpCVRå¡”çš„è®­ç»ƒä¿¡å·æ¥è‡ªäºpCTCVRçš„é¢„æµ‹ç»“æœï¼Œä»è€Œå·§å¦™åœ°è§£å†³äº†ç›´æ¥å¯¹CVRå»ºæ¨¡æ—¶å­˜åœ¨çš„**æ ·æœ¬é€‰æ‹©åå·®**ï¼ˆåªæœ‰ç‚¹å‡»æ ·æœ¬æ‰æœ‰è½¬åŒ–æ ‡ç­¾ï¼‰å’Œ**æ•°æ®ç¨€ç–**é—®é¢˜ã€‚\n\n## ğŸ“– å»¶ä¼¸é˜…è¯»\n\n1.  [Wide & Deep Learning for Recommender Systems (DLRS'16)](https://arxiv.org/abs/1606.07792) - æ·±åº¦å­¦ä¹ æ¨èçš„å¼€å±±ä¹‹ä½œã€‚\n2.  [DeepFM: A Factorization-Machine based Neural Network for CTR Prediction (IJCAI'17)](https://arxiv.org/abs/1703.04247) - ä¼˜é›…åœ°ç»Ÿä¸€äº†ä½é˜¶å’Œé«˜é˜¶ç‰¹å¾äº¤å‰ã€‚\n3.  [Deep Interest Network for Click-Through Rate Prediction (KDD'18)](https://arxiv.org/abs/1706.06978) - å°†æ³¨æ„åŠ›æœºåˆ¶æˆåŠŸå¼•å…¥æ¨èé¢†åŸŸã€‚\n4.  [Entire Space Multi-Task Model: An Effective Approach for Estimating Post-Click Conversion Rate (SIGIR'18)](https://arxiv.org/abs/1804.07931) - å¤šä»»åŠ¡å­¦ä¹ çš„ç»å…¸èŒƒå¼ã€‚\n\n> ğŸ§  **æ€è€ƒé¢˜**\n> \n> 1. **ç‰¹å¾é€‰æ‹©**ï¼šåœ¨è®¾è®¡Wide & Deepæ¨¡å‹æ—¶ï¼Œä½ ä¼šå¦‚ä½•åˆ’åˆ†ç‰¹å¾è¿›å…¥Wideéƒ¨åˆ†å’ŒDeepéƒ¨åˆ†ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜å¹¶é™ˆè¿°ä½ çš„ç†ç”±ã€‚\n> 2. **å†·å¯åŠ¨é—®é¢˜**ï¼šå¯¹äºä¸€ä¸ªæ²¡æœ‰ä»»ä½•å†å²è¡Œä¸ºçš„æ–°ç”¨æˆ·ï¼Œä½ è®¤ä¸ºDeepFMå’ŒDINå“ªä¸ªæ¨¡å‹èƒ½æ›´å¥½åœ°å¤„ç†ä»–çš„æ¨èè¯·æ±‚ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n> 3. **æ³¨æ„åŠ›å¤±æ•ˆ**ï¼šåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä½ è®¤ä¸ºDINçš„æ³¨æ„åŠ›æœºåˆ¶å¯èƒ½ä¼š\"å¤±æ•ˆ\"æˆ–è€…è¯´ä¸èµ·ä½œç”¨ï¼Ÿï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·çš„è¡Œä¸ºåºåˆ—éå¸¸çŸ­ï¼Œæˆ–è€…è¡Œä¸ºéå¸¸å•ä¸€ï¼‰\n> 4. **å¤šä»»åŠ¡çš„æŒ‘æˆ˜**ï¼šé™¤äº†ESMMï¼Œä½ è¿˜èƒ½æƒ³åˆ°å“ªäº›æ–¹æ³•æ¥è§£å†³å¤šä»»åŠ¡å­¦ä¹ ä¸­å¯èƒ½å‡ºç°çš„\"è··è··æ¿æ•ˆåº”\"ï¼ˆå³ä¸€ä¸ªä»»åŠ¡æ€§èƒ½æå‡ï¼Œå¦ä¸€ä¸ªä»»åŠ¡æ€§èƒ½ä¸‹é™ï¼‰ï¼Ÿï¼ˆæç¤ºï¼šå¯ä»¥æ€è€ƒMMoEç­‰æ¨¡å‹ï¼‰\n> 5. **è¶…è¶ŠID**ï¼šæœ¬ç« è®¨è®ºçš„æ¨¡å‹ä¸»è¦åŸºäºç”¨æˆ·çš„è¡Œä¸ºIDåºåˆ—ã€‚å¦‚æœä½ çš„ç‰©å“æœ‰ä¸°å¯Œçš„æ–‡æœ¬æˆ–å›¾åƒå†…å®¹ï¼Œä½ ä¼šå¦‚ä½•æ”¹é€ è¿™äº›æ¨¡å‹æ¥åˆ©ç”¨è¿™äº›å¤šæ¨¡æ€ä¿¡æ¯ï¼Ÿ\n\n::: tip ğŸ‰ ç« èŠ‚å°ç»“\næ·±åº¦å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„\"æ–‡è‰ºå¤å…´\"ï¼Œæœ¬è´¨ä¸Šæ˜¯ä»æ‰‹å·¥ç‰¹å¾å·¥ç¨‹å‘è‡ªåŠ¨è¡¨ç¤ºå­¦ä¹ çš„èŒƒå¼è½¬å˜ã€‚Wide & Deepå¼€å¯äº†è®°å¿†ä¸æ³›åŒ–å¹¶é‡çš„æ—¶ä»£ï¼ŒDeepFMå®ç°äº†çœŸæ­£çš„ç«¯åˆ°ç«¯å­¦ä¹ ï¼ŒDINåˆ™è®©æˆ‘ä»¬ç†è§£äº†ç”¨æˆ·å…´è¶£çš„åŠ¨æ€æ€§ã€‚è¿™åœºé©å‘½ä¸ä»…è§£æ”¾äº†ç®—æ³•å·¥ç¨‹å¸ˆçš„åŒæ‰‹ï¼Œæ›´é‡è¦çš„æ˜¯è®©æ¨èç³»ç»Ÿå…·å¤‡äº†ç†è§£å¤æ‚ç”¨æˆ·è¡Œä¸ºæ¨¡å¼çš„èƒ½åŠ›ã€‚ä»é™æ€ç”»åƒåˆ°åŠ¨æ€æ„å›¾ï¼Œä»å•ä¸€ç›®æ ‡åˆ°å¤šä»»åŠ¡ä¼˜åŒ–ï¼Œæ·±åº¦å­¦ä¹ ä¸ºæ¨èç³»ç»Ÿæ³¨å…¥äº†å‰æ‰€æœªæœ‰çš„æ™ºèƒ½ã€‚\n:::\n\n---\n\n> \"The best way to predict the future is to invent it.\" â€”â€” Alan Kay  \n> æ·±åº¦å­¦ä¹ ä¸ä»…é¢„æµ‹äº†æ¨èç³»ç»Ÿçš„æœªæ¥ï¼Œæ›´æ˜¯äº²æ‰‹åˆ›é€ äº†è¿™ä¸ªæ™ºèƒ½åŒ–çš„æœªæ¥ã€‚","excerpt":"","includedFiles":[],"tasklistId":0,"title":"","headers":[{"level":2,"title":"ğŸš€ èŒƒå¼é©å‘½ï¼šä»\"ç‰¹å¾å·¥ç¨‹\"åˆ°\"è¡¨ç¤ºå­¦ä¹ \"","slug":"ğŸš€-èŒƒå¼é©å‘½-ä»-ç‰¹å¾å·¥ç¨‹-åˆ°-è¡¨ç¤ºå­¦ä¹ ","link":"#ğŸš€-èŒƒå¼é©å‘½-ä»-ç‰¹å¾å·¥ç¨‹-åˆ°-è¡¨ç¤ºå­¦ä¹ ","children":[]},{"level":2,"title":"ğŸ¯ æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯","slug":"ğŸ¯-æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯","link":"#ğŸ¯-æ ¸å¿ƒæ¨¡å‹æ¼”è¿›ä¹‹è·¯","children":[{"level":3,"title":"1. Wide & Deepï¼šè®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹","slug":"_1-wide-deep-è®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹","link":"#_1-wide-deep-è®°å¿†ä¸æ³›åŒ–çš„é¦–æ¬¡æ¡æ‰‹","children":[]},{"level":3,"title":"2. DeepFMï¼šç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰","slug":"_2-deepfm-ç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰","link":"#_2-deepfm-ç»ˆç»“æ‰‹å·¥ç‰¹å¾äº¤å‰","children":[]},{"level":3,"title":"3. DINï¼šæ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£","slug":"_3-din-æ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£","link":"#_3-din-æ´å¯Ÿç”¨æˆ·åŠ¨æ€å…´è¶£","children":[]}]},{"level":2,"title":"ğŸ™ï¸ åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§ï¼šå¤šä»»åŠ¡å­¦ä¹ ","slug":"ğŸ™ï¸-åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§-å¤šä»»åŠ¡å­¦ä¹ ","link":"#ğŸ™ï¸-åº”å¯¹çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§-å¤šä»»åŠ¡å­¦ä¹ ","children":[]},{"level":2,"title":"ğŸ“– å»¶ä¼¸é˜…è¯»","slug":"ğŸ“–-å»¶ä¼¸é˜…è¯»","link":"#ğŸ“–-å»¶ä¼¸é˜…è¯»","children":[]}]}}
