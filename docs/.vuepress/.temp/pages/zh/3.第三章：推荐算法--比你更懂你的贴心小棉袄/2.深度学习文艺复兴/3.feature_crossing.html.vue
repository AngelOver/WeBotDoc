<template><div><p>想象一下，一个推荐系统如果只会单独看特征，会发生什么？</p>
<ul>
<li>它看到&quot;用户A是女性&quot;，可能会推荐所有女性化的商品。</li>
<li>它看到&quot;商品B是口红&quot;，可能会推荐给所有用户。</li>
</ul>
<p>这显然不够聪明。一个好的推荐系统，必须理解特征之间的&quot;化学反应&quot;：</p>
<ul>
<li><strong>&quot;用户是年轻女性&quot; + &quot;商品是口红&quot; → 点击率飙升</strong></li>
<li><strong>&quot;时间是深夜&quot; + &quot;商品是零食&quot; → 转化率提高</strong></li>
<li><strong>&quot;用户刚买了手机&quot; + &quot;商品是手机壳&quot; → 强关联</strong></li>
</ul>
<p>这种挖掘特征之间隐藏关系的能力，就是<strong>特征交叉</strong>。它决定了模型效果的天花板，是推荐系统从&quot;能用&quot;到&quot;好用&quot;的关键，堪称推荐模型的&quot;灵魂&quot;。</p>
<h2 id="🗿-石器时代-人工特征交叉的-辛酸泪" tabindex="-1"><a class="header-anchor" href="#🗿-石器时代-人工特征交叉的-辛酸泪"><span>🗿 石器时代：人工特征交叉的&quot;辛酸泪&quot;</span></a></h2>
<p>在早期，工程师们扮演着&quot;炼丹师&quot;的角色，依靠领域知识和经验，手动创造交叉特征。</p>
<ul>
<li><strong>方法</strong>：<code v-pre>IF user.gender='female' AND item.category='makeup' THEN feature_A=1</code></li>
<li><strong>优点</strong>：可解释性强，直观可控。</li>
<li><strong>痛点</strong>：
<ol>
<li><strong>组合爆炸</strong>：几个特征就能组合出成千上万的新特征，无法穷举。</li>
<li><strong>依赖经验</strong>：高度依赖工程师的业务理解，容易遗漏关键交叉。</li>
<li><strong>难以泛化</strong>：对训练集中未出现过的组合无能为力。</li>
</ol>
</li>
</ul>
<p>这个阶段费时费力，且效果难以保证，我们迫切需要一种能自动学习特征交叉的方法。</p>
<h2 id="🚗-自动挡革命-fm-优雅地推开新世界大门" tabindex="-1"><a class="header-anchor" href="#🚗-自动挡革命-fm-优雅地推开新世界大门"><span>🚗 自动挡革命：FM，优雅地推开新世界大门</span></a></h2>
<p>FM (Factorization Machines) 的出现，如同给推荐系统装上了&quot;自动挡&quot;，优雅地解决了特征交叉问题。</p>
<h3 id="fm的核心思想" tabindex="-1"><a class="header-anchor" href="#fm的核心思想"><span>FM的核心思想</span></a></h3>
<p>FM的构思堪称天才：<strong>为每个特征学习一个隐向量（Embedding），用向量内积来代表特征间的交叉强度。</strong></p>
<ul>
<li><strong>特征</strong>：<code v-pre>用户=小明</code>，<code v-pre>性别=男</code>，<code v-pre>物品=游戏机</code>，<code v-pre>类别=电子产品</code>...</li>
<li><strong>隐向量</strong>：
<ul>
<li><code v-pre>v(小明)</code> = [0.1, -0.5, ...]</li>
<li><code v-pre>v(游戏机)</code> = [0.2, -0.4, ...]</li>
</ul>
</li>
<li><strong>交叉强度</strong>：<code v-pre>v(小明)</code> · <code v-pre>v(游戏机)</code> 的点积结果。如果点积值大，说明&quot;小明&quot;和&quot;游戏机&quot;的关联性强。</li>
</ul>
<p>由于所有特征都被映射到了同一个隐空间，即使&quot;小明&quot;从未买过&quot;PS5&quot;，模型也能通过<code v-pre>v(小明)</code>和<code v-pre>v(PS5)</code>的相似性，推断出他对PS5的兴趣，完美解决了数据稀疏和泛化问题。</p>
<h3 id="数学之美" tabindex="-1"><a class="header-anchor" href="#数学之美"><span>数学之美</span></a></h3>
<p>FM的公式简洁而强大：</p>
<p v-pre class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">⟨</mo><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub><mo stretchy="false">⟩</mo><msub><mi>x</mi><mi>i</mi></msub><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\hat{y}(\mathbf{x}) = w_0 + \sum_{i=1}^{n} w_i x_i + \sum_{i=1}^{n} \sum_{j=i+1}^{n} \langle \mathbf{v}_i, \mathbf{v}_j \rangle x_i x_j
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.0652em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><strong>第一部分</strong> (<span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">w_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>): 全局偏置，模型的基准线。</li>
<li><strong>第二部分</strong> (<span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum w_i x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>): 传统线性模型部分，建模单个特征的权重。</li>
<li><strong>第三部分</strong> (<span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><mo>∑</mo><mo stretchy="false">⟨</mo><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub><mo stretchy="false">⟩</mo><msub><mi>x</mi><mi>i</mi></msub><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\sum \sum \langle \mathbf{v}_i, \mathbf{v}_j \rangle x_i x_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑∑</span><span class="mopen">⟨</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>): FM的精髓，用隐向量内积自动计算所有二阶特征交叉的强度。</li>
</ul>
<p>FM通过一个巧妙的公式变换，将计算复杂度从 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(kn^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 降到了 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(kn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">kn</span><span class="mclose">)</span></span></span></span>，使其在工业界得以广泛应用。</p>
<h2 id="⛽️-混合动力时代-当-记忆-遇上-泛化" tabindex="-1"><a class="header-anchor" href="#⛽️-混合动力时代-当-记忆-遇上-泛化"><span>⛽️ 混合动力时代：当&quot;记忆&quot;遇上&quot;泛化&quot;</span></a></h2>
<p>FM虽然强大，但它主要捕捉的是二阶交叉。对于更高阶、更抽象的模式（例如&quot;'年轻女性'在'周末'喜欢'户外运动品牌'&quot;这种三阶关系），FM就显得力不从心。于是，结合了&quot;记忆&quot;与&quot;泛化&quot;的混合动力模型登场了。</p>
<h3 id="wide-deep-经典范式" tabindex="-1"><a class="header-anchor" href="#wide-deep-经典范式"><span>Wide &amp; Deep：经典范式</span></a></h3>
<p>Google提出的Wide &amp; Deep模型是这一思想的开创者。</p>
<ul>
<li><strong>Wide部分 (记忆)</strong>：一个广义线性模型，使用原始特征和少量人工交叉特征。它负责&quot;记住&quot;那些频繁出现、有明确业务含义的规则，比如&quot;买了A又买B&quot;的用户，下次直接推荐C。</li>
<li><strong>Deep部分 (泛化)</strong>：一个DNN，将稀疏特征Embedding后输入，负责学习高阶、抽象的特征交叉，探索那些隐藏的、意想不到的关联。</li>
</ul>
<p><strong>问题</strong>：Wide和Deep部分像两套独立的发动机，输入和训练都有所分离，不够优雅。</p>
<h3 id="deepfm-无缝衔接的集大成者" tabindex="-1"><a class="header-anchor" href="#deepfm-无缝衔接的集大成者"><span>DeepFM：无缝衔接的集大成者</span></a></h3>
<p>DeepFM对Wide &amp; Deep进行了完美升级。</p>
<ul>
<li><strong>共享Embedding</strong>：Wide部分（这里由FM替代）和Deep部分共享同一套特征Embedding。</li>
<li><strong>端到端训练</strong>：FM负责低阶（一阶和二阶）交叉，DNN负责高阶交叉，两者共同训练，无缝结合。</li>
</ul>
<p>DeepFM就像一套真正的一体化混合动力系统，不再需要人工为Wide部分设计特征，实现了真正的端到端学习，成为工业界应用最广泛的模型之一。</p>
<h2 id="🔬-精细化打磨-如何让交叉更-智能" tabindex="-1"><a class="header-anchor" href="#🔬-精细化打磨-如何让交叉更-智能"><span>🔬 精细化打磨：如何让交叉更&quot;智能&quot;？</span></a></h2>
<p>DeepFM之后，研究者们开始思考：所有的特征交叉都应该被平等对待吗？能不能让模型更&quot;智能&quot;地进行交叉？</p>
<h3 id="nfm-用神经网络-增强-交叉" tabindex="-1"><a class="header-anchor" href="#nfm-用神经网络-增强-交叉"><span>NFM：用神经网络&quot;增强&quot;交叉</span></a></h3>
<p>NFM (Neural Factorization Machines) 认为，FM用一个简单的内积来表示交叉强度，可能太&quot;草率&quot;了。</p>
<ul>
<li><strong>核心改进</strong>：它在FM的隐向量交叉后，不直接求和，而是先对每对交叉向量做<strong>元素积 (Element-wise Product)</strong>，得到一个&quot;交叉向量&quot;，然后将这些&quot;交叉向量&quot;喂给一个DNN。</li>
<li><strong>效果</strong>：相当于用一个更复杂的非线性网络来学习交叉模式，而不仅仅是简单的内积，理论上表达能力更强。</li>
</ul>
<h3 id="afm-给重要的交叉-加个鸡腿" tabindex="-1"><a class="header-anchor" href="#afm-给重要的交叉-加个鸡腿"><span>AFM：给重要的交叉&quot;加个鸡腿&quot;</span></a></h3>
<p>AFM (Attentional Factorization Machines) 的思路更直接：<strong>不是所有交叉都同等重要！</strong></p>
<ul>
<li><strong>核心改进</strong>：引入<strong>注意力机制 (Attention Mechanism)</strong>。在得到所有二阶交叉向量后，用一个Attention网络去学习每个交叉向量的&quot;重要性权重&quot;。</li>
<li><strong>效果</strong>：模型可以自动识别出哪些特征组合在当前预测中更关键（比如&quot;女性+口红&quot;的权重就应该高于&quot;女性+刮胡刀&quot;），并赋予它们更高的权重。这让模型不仅效果好，还具备了一定的可解释性。</li>
</ul>
<h2 id="🗺️-演进之路-一张图看懂特征交叉的进化" tabindex="-1"><a class="header-anchor" href="#🗺️-演进之路-一张图看懂特征交叉的进化"><span>🗺️ 演进之路：一张图看懂特征交叉的进化</span></a></h2>
<Mermaid id="mermaid-245" code="eJxtkc1OwkAQx+88RbMHL4b4AoYEWsrFNh5MPDQeIG2QRJFAeAATQEECGD5Ea/wmaTQxIglIqfAynV14C9tdjKUyl53d+e9v/7OTzMYzh9yeEOCcyOUTbI/I/QCuDXw1tCfPiNbcCCvINk0Y9Uh5DNPT7UR2KyTF0/n4EcdnT3K5VDqJDqhaS6sBH3J+9goVA1cf/dSIgkSJsmyru9CL5KZgm9VFd2ibL1Ave4ju6qPi0Qga5w4YKrofzCtoP6Vq3AYnaFqGvjB//4BZaRMPdKh2lmQ3BAW5mqUPUdoUZBmKfdt8ix4nNFVd7WyND/I5JZOSA/WbiCpI/m2P9gONGq71pJ1dz/OigsKrosoDHhi4UHfa8uhijk1eZrqvJmkZTE2+L8nkdp3BMBcMhrgIzSM052nO05xN3T13PvKiCf02+ncOT3dgmctR0GrUW7XaUOz9WaUCkQoEhm2N5zOdXcedMVh1pokFfgBrH/NL"></Mermaid><blockquote>
<p><strong>DCN (Deep &amp; Cross Network)</strong> 是另一条重要的演进路线，它设计了一个独特的Cross Network来显式地、逐层地进行高阶特征交叉，我们将在后续章节中详细探讨。</p>
</blockquote>
<p>📖 <strong>延伸阅读</strong></p>
<ol>
<li><a href="https://www.csie.ntu.edu.tw/~b97053/paper/Rendle2010FM.pdf" target="_blank" rel="noopener noreferrer">Factorization Machines</a> - FM 原始论文</li>
<li><a href="https://arxiv.org/abs/1703.04247" target="_blank" rel="noopener noreferrer">DeepFM: A Factorization-Machine based Neural Network for CTR Prediction</a> - DeepFM 论文</li>
<li><a href="https://arxiv.org/abs/1708.04617" target="_blank" rel="noopener noreferrer">Attentional Factorization Machines: Learning the Weight of Feature Interactions via Attention Networks</a> - AFM 论文</li>
<li><a href="https://arxiv.org/abs/1606.07792" target="_blank" rel="noopener noreferrer">Wide &amp; Deep Learning for Recommender Systems</a> - Google 的 Wide&amp;Deep 模型</li>
</ol>
<blockquote>
<p>🧠 <strong>思考题</strong></p>
<ol>
<li>为什么说DeepFM中的Embedding共享是其相比Wide&amp;Deep的核心优势？</li>
<li>在你的理解中，AFM的注意力和Transformer中的自注意力，它们的目标和机制有何异同？</li>
<li>如果让你设计一个新的特征交叉模型，你会从哪个角度对现有模型进行改进？</li>
</ol>
</blockquote>
<div class="hint-container tip">
<p class="hint-container-title">🎉 章节小结</p>
<p>特征交叉的演进史是推荐系统从&quot;手工艺&quot;走向&quot;工业化&quot;的缩影。从人工设计交叉特征的&quot;炼丹时代&quot;，到FM优雅地用隐向量内积自动学习二阶交叉，再到DeepFM将低阶记忆与高阶泛化完美融合，每一步都在追求更智能、更高效的特征组合方式。AFM和NFM等模型进一步证明了&quot;不是所有交叉都生而平等&quot;的道理。特征交叉的艺术，本质上是在有限的数据中发现无限的模式，让推荐系统具备洞察用户复杂偏好的能力。</p>
</div>
<hr>
<blockquote>
<p>&quot;The whole is greater than the sum of its parts.&quot; —— Aristotle<br>
在特征交叉的世界里，1+1永远大于2，组合的力量远超个体的简单相加。</p>
</blockquote>
</div></template>


